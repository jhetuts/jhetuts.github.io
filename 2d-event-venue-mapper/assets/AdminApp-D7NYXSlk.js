import{j as e,r as d,u as p,c as re,a as oe,b as Ut,P as de,d as se,e as Vt,f as at,g as Ce,h as ie,i as Ft,k as Kt,L as P,I as w,B as M,T as Ie,l as Gt,s as qt,m as Zt,n as V,o as F,p as K}from"./index-DjEWN0eY.js";import{c as _,M as Be,s as tt,i as Le,g as je,a as Jt,B as Qt,u as es,b as ts,d as ss,S as Ne,e as ke,f as Se,h as Ee,j as le,V as rs,X as os}from"./ViewerApp-O0ib4Sw_.js";const ns=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],as=_("arrow-left-right",ns);const is=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ls=_("arrow-right",is);const cs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ds=_("circle",cs);const hs=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ce=_("copy",hs);const xs=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],us=_("download",xs);const fs=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ps=_("eye",fs);const ms=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],vs=_("history",ms);const gs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],it=_("image",gs);const bs=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],js=_("layers",bs);const ws=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],ys=_("monitor",ws);const Cs=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],Ns=_("mouse-pointer-2",Cs);const ks=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],Ss=_("mouse-pointer-click",ks);const Es=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ts=_("plus",Es);const Ps=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],Rs=_("redo-2",Ps);const Ms=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],As=_("rotate-ccw",Ms);const _s=[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]],lt=_("spline",_s);const zs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ct=_("square",zs);const Ds=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],he=_("trash-2",Ds);const Ls=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],dt=_("type",Ls);const Is=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Bs=_("undo-2",Is);const Ws=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Hs=_("upload",Ws);function Ys({gridSize:t}){return e.jsx("defs",{children:e.jsx("pattern",{id:"admin-grid-pattern",width:t,height:t,patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:`M ${t} 0 L 0 0 0 ${t}`,fill:"none",stroke:"#cbd5e1",strokeWidth:"1",opacity:"0.8"})})})}function $s({element:t,isSelected:o,onSelect:r}){const i=t.x+t.width/2,s=t.y+t.height/2,[h,x]=d.useState(!0),u=!!t.logoUrl&&h,c=6,m=t.width-c*2,a=t.height-c*2;return e.jsxs("g",{onClick:n=>{n.stopPropagation(),r(t.id,n)},style:{cursor:"pointer"},transform:t.rotation?`rotate(${t.rotation} ${i} ${s})`:void 0,children:[t.shape==="circle"?e.jsxs(e.Fragment,{children:[e.jsx("ellipse",{cx:i,cy:s,rx:t.width/2,ry:t.height/2,fill:t.fillEnabled!==!1?t.fillColor:"transparent",stroke:t.borderColor??"#1f2937",strokeWidth:t.borderWidth??1}),o&&e.jsx("ellipse",{cx:i,cy:s,rx:t.width/2+2,ry:t.height/2+2,fill:"none",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"}),u&&e.jsx("clipPath",{id:`clip-logo-${t.id}`,children:e.jsx("ellipse",{cx:i,cy:s,rx:m/2,ry:a/2})})]}):e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,rx:Math.max(0,t.borderRadius??10),fill:t.fillEnabled!==!1?t.fillColor:"transparent",stroke:t.borderColor??"#1f2937",strokeWidth:t.borderWidth??1}),o&&e.jsx("rect",{x:t.x-2,y:t.y-2,width:t.width+4,height:t.height+4,rx:Math.max(0,(t.borderRadius??10)+2),fill:"none",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"}),u&&e.jsx("clipPath",{id:`clip-logo-${t.id}`,children:e.jsx("rect",{x:t.x+c,y:t.y+c,width:m,height:a,rx:Math.max(0,(t.borderRadius??10)-2)})})]}),u?e.jsx("image",{href:t.logoUrl,x:t.x+c,y:t.y+c,width:m,height:a,preserveAspectRatio:"xMidYMid meet",clipPath:`url(#clip-logo-${t.id})`,pointerEvents:"none",onError:()=>x(!1)}):e.jsxs(e.Fragment,{children:[e.jsx("text",{x:i,y:s-6,textAnchor:"middle",dominantBaseline:"middle",fill:t.textColor,fontSize:12,fontWeight:"600",pointerEvents:"none",children:t.name}),e.jsxs("text",{x:i,y:s+8,textAnchor:"middle",dominantBaseline:"middle",fill:t.textColor,fontSize:10,opacity:.7,pointerEvents:"none",children:["#",t.boothNumber]})]}),t.isStartingPoint&&e.jsx("foreignObject",{x:i-10,y:t.y-22,width:20,height:20,pointerEvents:"none",children:e.jsx(Be,{className:"h-5 w-5 text-red-500"})})]})}function Xs({element:t,isSelected:o,onSelect:r}){const i=t.x+t.width/2,s=t.y+t.height/2;return e.jsxs("g",{onClick:h=>{h.stopPropagation(),r(t.id,h)},style:{cursor:"pointer"},transform:t.rotation?`rotate(${t.rotation} ${i} ${s})`:void 0,children:[o&&e.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:"transparent",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"}),e.jsx("foreignObject",{x:t.x,y:t.y,width:t.width,height:t.height,children:e.jsx("div",{style:{fontSize:t.fontSize,fontWeight:t.fontWeight,color:t.textColor,backgroundColor:t.fillColor==="transparent"?void 0:t.fillColor,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",padding:"4px"},children:t.text})})]})}function Os({element:t,isSelected:o,onSelect:r}){const i=t.x+t.width/2,s=t.y+t.height/2;return e.jsxs("g",{onClick:h=>{h.stopPropagation(),r(t.id,h)},style:{cursor:"pointer"},transform:t.rotation?`rotate(${t.rotation} ${i} ${s})`:void 0,children:[e.jsx("image",{href:t.imageUrl,x:t.x,y:t.y,width:t.width,height:t.height,opacity:t.opacity,preserveAspectRatio:"xMidYMid slice"}),o&&e.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:"transparent",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"})]})}function Us({element:t,isSelected:o,onSelect:r}){if(t.points.length<2)return null;const i=`arrow-${t.id}`,s=t.points.map(c=>`${c.x},${c.y}`).join(" "),h=t.connectorType==="directional",x=t.connectorType==="bidirectional",u=`arrow-start-${t.id}`;return e.jsxs("g",{onClick:c=>{c.stopPropagation(),r(t.id,c)},style:{cursor:"pointer"},children:[e.jsxs("defs",{children:[(h||x)&&e.jsx("marker",{id:i,viewBox:"0 0 10 7",refX:"10",refY:"3.5",markerWidth:"8",markerHeight:"6",orient:"auto-start-reverse",children:e.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:t.strokeColor})}),x&&e.jsx("marker",{id:u,viewBox:"0 0 10 7",refX:"0",refY:"3.5",markerWidth:"8",markerHeight:"6",orient:"auto-start-reverse",children:e.jsx("polygon",{points:"10 0, 0 3.5, 10 7",fill:t.strokeColor})})]}),o&&e.jsx("polyline",{points:s,fill:"none",stroke:"#3b82f6",strokeWidth:t.strokeWidth+4,strokeDasharray:"6 3",opacity:.4}),e.jsx("polyline",{points:s,fill:"none",stroke:t.strokeColor,strokeWidth:t.strokeWidth,strokeLinejoin:"round",strokeLinecap:"round",markerEnd:h||x?`url(#${i})`:void 0,markerStart:x?`url(#${u})`:void 0})]})}function Vs({element:t,isSelected:o,onSelect:r}){switch(t.type){case"booth":return e.jsx($s,{element:t,isSelected:o,onSelect:r});case"text":return e.jsx(Xs,{element:t,isSelected:o,onSelect:r});case"image":return e.jsx(Os,{element:t,isSelected:o,onSelect:r});case"connector":return e.jsx(Us,{element:t,isSelected:o,onSelect:r})}}const st=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1"];function rt(){return st[Math.floor(Math.random()*st.length)]}const ee=8;function Fs(){const t=d.useRef(null),o=d.useRef(null),[r,i]=d.useState(null),[s,h]=d.useState(null),[x,u]=d.useState(null),[c,m]=d.useState(1),[a,n]=d.useState({x:0,y:0}),[g,k]=d.useState(null),[y,D]=d.useState(!1),[B,I]=d.useState(!1),Y=d.useRef({x:0,y:0,panX:0,panY:0}),$=d.useRef(!1),q=p(l=>l.removeElements),ne=p(l=>l.duplicateElements),Q=p(l=>l.moveElements);d.useEffect(()=>{const l=f=>{if(f.target instanceof HTMLInputElement||f.target instanceof HTMLTextAreaElement)return;if(f.code==="Space"&&!f.repeat){f.preventDefault(),I(!0);return}const C=p.getState(),S=C.selectedElementIds;(f.key==="Delete"||f.key==="Backspace")&&S.length>0&&(f.preventDefault(),q(S)),(f.ctrlKey||f.metaKey)&&f.key==="d"&&S.length>0&&(f.preventDefault(),ne(S));const E={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]}[f.key];if(E&&S.length>0){f.preventDefault();const z=f.shiftKey?C.venue.snapToGrid?C.venue.gridSize:10:1;Q(S,E[0]*z,E[1]*z)}},b=f=>{f.code==="Space"&&I(!1)};return window.addEventListener("keydown",l),window.addEventListener("keyup",b),()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",b)}},[q,ne,Q]),d.useEffect(()=>{const l=o.current;if(!l)return;const b=f=>f.preventDefault();return l.addEventListener("contextmenu",b),()=>l.removeEventListener("contextmenu",b)},[]);const v=p(l=>l.venue),A=p(l=>l.elements),T=p(l=>l.selectedElementIds),R=p(l=>l.activeTool),L=p(l=>l.setSelectedElement),Ae=p(l=>l.toggleSelectedElement),pe=p(l=>l.addElement),Ue=p(l=>l.moveElement),Ve=p(l=>l.moveElements),Fe=p(l=>l.resizeElement),ge=p(l=>l.setStartingPoint),me=p(l=>l.setActiveTool),Ke=p(l=>l.setVenue),xe=T.length===1?T[0]:null,Z=d.useCallback((l,b)=>{const f=t.current;if(!f)return{x:0,y:0};const C=f.getBoundingClientRect(),S=(l-C.left)/c,j=(b-C.top)/c;return{x:S,y:j}},[c]),U=d.useCallback(l=>v.snapToGrid?tt(l,v.gridSize):l,[v.snapToGrid,v.gridSize]),Ge=d.useCallback((l,b)=>A.find(f=>Le(f)&&l>=f.x&&l<=f.x+f.width&&b>=f.y&&b<=f.y+f.height),[A]),_t=d.useCallback(l=>{if($.current){$.current=!1;return}if(r||s||x)return;const{x:b,y:f}=Z(l.clientX,l.clientY),C=U(b),S=U(f);switch(R){case"booth-circle":{const j={id:je(),type:"booth",shape:"circle",x:C-40,y:S-40,width:80,height:80,rotation:0,name:"Booth",boothNumber:String(A.filter(E=>E.type==="booth").length+1),tierId:v.tiers[0]?.id,fillEnabled:!0,fillColor:rt(),borderColor:"#1f2937",borderWidth:1,borderRadius:16,textColor:"#ffffff",showWebsiteCTA:!0,showDescription:!0,isStartingPoint:!1,websiteCtaText:"Visit website",websiteCtaButtonColor:"#111827",websiteCtaTextColor:"#ffffff",websiteCtaRadius:10,showVisitedCTA:!1,visitedCtaText:"Mark as visited",visitedCtaButtonColor:"#111827",visitedCtaTextColor:"#ffffff",visitedCtaRadius:10,showFavoriteCTA:!1,favoriteCtaText:"Mark as favorite",favoriteCtaButtonColor:"#111827",favoriteCtaTextColor:"#ffffff",favoriteCtaRadius:10,showRateCTA:!1,rateCtaText:"Rate",rateCtaButtonColor:"#111827",rateCtaTextColor:"#ffffff",rateCtaRadius:10,showDirectionCTA:!0,directionCtaText:"Get direction",directionCtaButtonColor:"#111827",directionCtaTextColor:"#ffffff",directionCtaRadius:10,popupConfigured:!1};pe(j),L(j.id),me("select");break}case"booth-square":{const j={id:je(),type:"booth",shape:"square",x:C-50,y:S-40,width:100,height:80,rotation:0,name:"Booth",boothNumber:String(A.filter(E=>E.type==="booth").length+1),tierId:v.tiers[0]?.id,fillEnabled:!0,fillColor:rt(),borderColor:"#1f2937",borderWidth:1,borderRadius:10,textColor:"#ffffff",showWebsiteCTA:!0,showDescription:!0,isStartingPoint:!1,websiteCtaText:"Visit website",websiteCtaButtonColor:"#111827",websiteCtaTextColor:"#ffffff",websiteCtaRadius:10,showVisitedCTA:!1,visitedCtaText:"Mark as visited",visitedCtaButtonColor:"#111827",visitedCtaTextColor:"#ffffff",visitedCtaRadius:10,showFavoriteCTA:!1,favoriteCtaText:"Mark as favorite",favoriteCtaButtonColor:"#111827",favoriteCtaTextColor:"#ffffff",favoriteCtaRadius:10,showRateCTA:!1,rateCtaText:"Rate",rateCtaButtonColor:"#111827",rateCtaTextColor:"#ffffff",rateCtaRadius:10,showDirectionCTA:!0,directionCtaText:"Get direction",directionCtaButtonColor:"#111827",directionCtaTextColor:"#ffffff",directionCtaRadius:10,popupConfigured:!1};pe(j),L(j.id),me("select");break}case"text":{const j={id:je(),type:"text",x:C-60,y:S-15,width:120,height:30,rotation:0,text:"New Text",fontSize:16,fontWeight:"normal",fillColor:"transparent",textColor:"#000000"};pe(j),L(j.id),me("select");break}case"image":{const j=window.prompt("Enter image URL:");if(j){const E={id:je(),type:"image",x:C-75,y:S-50,width:150,height:100,rotation:0,imageUrl:j,opacity:1};pe(E),L(E.id)}me("select");break}case"starting-point":{const j=Ge(b,f);j&&ge(j.id);break}default:L(null);break}},[R,Z,U,A,v.tiers,r,s,x,pe,L,me,ge,Ge]),zt=d.useCallback((l,b)=>{if(R==="starting-point"){const f=A.find(C=>C.id===l);f&&Le(f)&&ge(l);return}b&&(b.ctrlKey||b.metaKey||b.shiftKey)?Ae(l):L(l)},[R,A,L,Ae,ge]),be=d.useCallback((l,b)=>{const f=o.current;if(!f)return null;const C=f.getBoundingClientRect(),S=C.left+a.x,j=C.top+a.y,E=S+v.width*c,z=j+v.height*c,O=Math.abs(l-S)<=ee,ae=Math.abs(l-E)<=ee,ze=Math.abs(b-j)<=ee,De=Math.abs(b-z)<=ee,Qe=l>=S-ee&&l<=E+ee,et=b>=j-ee&&b<=z+ee;return O&&ze?"canvas-top-left":ae&&ze?"canvas-top-right":O&&De?"canvas-bottom-left":ae&&De?"canvas-bottom-right":O&&et?"canvas-left":ae&&et?"canvas-right":ze&&Qe?"canvas-top":De&&Qe?"canvas-bottom":null},[a,c,v.width,v.height]),[W,Dt]=d.useState(null),Lt=d.useCallback(l=>{if(s){const b=(l.clientX-s.startX)/c,f=(l.clientY-s.startY)/c,C=O=>v.snapToGrid?tt(O,v.gridSize):O;let S=s.startWidth,j=s.startHeight,E=s.startPanX,z=s.startPanY;(s.type==="canvas-right"||s.type==="canvas-top-right"||s.type==="canvas-bottom-right")&&(S=Math.max(200,C(s.startWidth+b))),(s.type==="canvas-left"||s.type==="canvas-top-left"||s.type==="canvas-bottom-left")&&(S=Math.max(200,C(s.startWidth-b)),E=s.startPanX+(s.startWidth-S)*c),(s.type==="canvas-bottom"||s.type==="canvas-bottom-left"||s.type==="canvas-bottom-right")&&(j=Math.max(200,C(s.startHeight+f))),(s.type==="canvas-top"||s.type==="canvas-top-left"||s.type==="canvas-top-right")&&(j=Math.max(200,C(s.startHeight-f)),z=s.startPanY+(s.startHeight-j)*c),Ke({width:S,height:j}),n({x:E,y:z});return}R==="select"&&!r&&!y&&Dt(be(l.clientX,l.clientY))},[s,R,r,y,c,v.snapToGrid,v.gridSize,be,Ke]),It=d.useCallback(l=>{if(R!=="select")return;const b=be(l.clientX,l.clientY);b&&(l.preventDefault(),l.stopPropagation(),h({type:b,startX:l.clientX,startY:l.clientY,startWidth:v.width,startHeight:v.height,startPanX:a.x,startPanY:a.y}))},[R,be,v.width,v.height,a.x,a.y]),qe=d.useCallback(()=>{h(null)},[]),Bt=d.useCallback(l=>{if(s)return;if(l.button===1||l.button===2||l.button===0&&l.altKey||l.button===0&&B){D(!0),Y.current={x:l.clientX,y:l.clientY,panX:a.x,panY:a.y},l.preventDefault();return}const f=l.target;if(f.closest("[data-resize-handle]")&&xe){const j=Z(l.clientX,l.clientY),E=A.find(z=>z.id===xe);E&&"width"in E&&i({elementId:xe,offsetX:j.x-(E.x+E.width),offsetY:j.y-(E.y+E.height),type:"resize"}),l.stopPropagation();return}const S=f.closest("[data-element-id]");if(S&&R==="select"){const j=S.getAttribute("data-element-id"),E=A.find(z=>z.id===j);if(E&&"x"in E){const z=Z(l.clientX,l.clientY),O=T.includes(j),ae=O&&T.length>1;!O&&!l.ctrlKey&&!l.metaKey&&!l.shiftKey&&L(j),i({elementId:j,offsetX:z.x-E.x,offsetY:z.y-E.y,type:"move",multi:ae||T.length>1&&(l.ctrlKey||l.metaKey||l.shiftKey),lastX:z.x,lastY:z.y})}return}if(R==="select"&&l.button===0&&!S){const j=Z(l.clientX,l.clientY);u({startX:j.x,startY:j.y,currentX:j.x,currentY:j.y})}},[s,R,T,xe,A,Z,a,B,L]),Wt=d.useCallback(l=>{if(y){const f=l.clientX-Y.current.x,C=l.clientY-Y.current.y;n({x:Y.current.panX+f,y:Y.current.panY+C});return}if(x){const f=Z(l.clientX,l.clientY);u(C=>C?{...C,currentX:f.x,currentY:f.y}:null);return}if(!r)return;const b=Z(l.clientX,l.clientY);if(r.type==="move")if(r.multi&&T.length>1){const f=U(b.x-(r.lastX??b.x)),C=U(b.y-(r.lastY??b.y));(f!==0||C!==0)&&(Ve(T,f,C),i({...r,lastX:(r.lastX??b.x)+f,lastY:(r.lastY??b.y)+C}))}else{const f=U(b.x-r.offsetX),C=U(b.y-r.offsetY);Ue(r.elementId,f,C)}else{const f=A.find(C=>C.id===r.elementId);if(f&&"width"in f){const C=Math.max(20,U(b.x-r.offsetX-f.x)),S=Math.max(20,U(b.y-r.offsetY-f.y));Fe(r.elementId,C,S)}}},[r,y,x,Z,U,Ue,Ve,Fe,A,T]),Ze=d.useCallback(()=>{if(x){const l=Math.min(x.startX,x.currentX),b=Math.min(x.startY,x.currentY),f=Math.abs(x.currentX-x.startX),C=Math.abs(x.currentY-x.startY);if(f>3||C>3){const S=A.filter(j=>{if(!("x"in j&&"width"in j))return!1;const E=j.x,z=j.y,O=j.width,ae=j.height;return E<l+f&&E+O>l&&z<b+C&&z+ae>b}).map(j=>j.id);S.length>0?(p.setState({selectedElementIds:S}),$.current=!0):L(null)}u(null);return}i(null),D(!1)},[x,A,L]),_e=d.useCallback(l=>{l.preventDefault();const b=l.deltaY>0?.95:1.05;m(f=>Math.min(5,Math.max(.1,f*b)))},[]);d.useEffect(()=>{const l=o.current;if(l)return l.addEventListener("wheel",_e,{passive:!1}),()=>l.removeEventListener("wheel",_e)},[_e]);const Ht=d.useCallback(()=>m(l=>Math.min(5,l*1.25)),[]),Yt=d.useCallback(()=>m(l=>Math.max(.1,l*.8)),[]),$t=d.useCallback(()=>{m(1),n({x:0,y:0})},[]),Xt=d.useCallback(()=>{const l=t.current?.parentElement;if(!l)return;const b=l.clientWidth,f=l.clientHeight,C=Math.min(b/v.width,f/v.height)*.9;m(Math.min(5,Math.max(.1,C))),n({x:(b-v.width*C)/2,y:(f-v.height*C)/2})},[v.width,v.height]),J=xe?A.find(l=>l.id===xe):null,ue=J&&Le(J)?J:null,Ot=ue&&ue.popupConfigured&&ue.id!==g?ue:null,Je=s?s.type==="canvas-left"||s.type==="canvas-right"?"ew-resize":s.type==="canvas-top"||s.type==="canvas-bottom"?"ns-resize":s.type==="canvas-top-left"||s.type==="canvas-bottom-right"?"nwse-resize":"nesw-resize":W==="canvas-left"||W==="canvas-right"?"ew-resize":W==="canvas-top"||W==="canvas-bottom"?"ns-resize":W==="canvas-top-left"||W==="canvas-bottom-right"?"nwse-resize":W==="canvas-top-right"||W==="canvas-bottom-left"?"nesw-resize":void 0;return e.jsxs("div",{ref:o,className:"relative flex-1 overflow-hidden bg-muted",onMouseMove:Lt,onMouseDown:It,onMouseUp:qe,onMouseLeave:qe,style:{cursor:Je},children:[e.jsxs("svg",{ref:t,width:v.width*c,height:v.height*c,viewBox:`0 0 ${v.width} ${v.height}`,className:"absolute",style:{left:a.x,top:a.y,cursor:Je?void 0:y?"grabbing":B?"grab":x?"crosshair":r?"move":R!=="select"?"crosshair":"default"},onClick:_t,onMouseDown:Bt,onMouseMove:Wt,onMouseUp:Ze,onMouseLeave:Ze,children:[e.jsx("rect",{x:"0",y:"0",width:v.width,height:v.height,fill:v.backgroundColor}),!v.backgroundImage&&e.jsx(Jt,{venue:v,elements:A,idPrefix:"admin-map-bg",opacity:.55}),v.backgroundImage&&e.jsx("image",{href:v.backgroundImage,x:"0",y:"0",width:v.width,height:v.height,opacity:v.backgroundOpacity,preserveAspectRatio:"xMidYMid slice",style:{pointerEvents:"none"}}),v.showGrid&&e.jsxs(e.Fragment,{children:[e.jsx(Ys,{gridSize:v.gridSize}),e.jsx("rect",{x:"0",y:"0",width:v.width,height:v.height,fill:"url(#admin-grid-pattern)"})]}),A.map(l=>e.jsx("g",{"data-element-id":l.id,children:e.jsx(Vs,{element:l,isSelected:T.includes(l.id),onSelect:zt})},l.id)),J&&"width"in J&&e.jsx("rect",{"data-resize-handle":!0,x:J.x+J.width-5,y:J.y+J.height-5,width:10,height:10,fill:"#3b82f6",stroke:"#fff",strokeWidth:1,style:{cursor:"nwse-resize"}}),R==="select"&&e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:-3,y:v.height/2-20,width:6,height:40,rx:3,fill:"#94a3b8",opacity:W==="canvas-left"||s?.type==="canvas-left"?.9:.35,style:{cursor:"ew-resize",pointerEvents:"none"}}),e.jsx("rect",{x:v.width-3,y:v.height/2-20,width:6,height:40,rx:3,fill:"#94a3b8",opacity:W==="canvas-right"||s?.type==="canvas-right"?.9:.3,style:{cursor:"ew-resize",pointerEvents:"none"}}),e.jsx("rect",{x:v.width/2-20,y:-3,width:40,height:6,rx:3,fill:"#94a3b8",opacity:W==="canvas-top"||s?.type==="canvas-top"?.9:.35,style:{cursor:"ns-resize",pointerEvents:"none"}}),e.jsx("rect",{x:v.width/2-20,y:v.height-3,width:40,height:6,rx:3,fill:"#94a3b8",opacity:W==="canvas-bottom"||s?.type==="canvas-bottom"?.9:.3,style:{cursor:"ns-resize",pointerEvents:"none"}}),e.jsx("rect",{x:-8,y:-8,width:10,height:10,rx:2,fill:"#64748b",opacity:W==="canvas-top-left"||s?.type==="canvas-top-left"?.9:.4,style:{cursor:"nwse-resize",pointerEvents:"none"}}),e.jsx("rect",{x:v.width-8,y:-8,width:10,height:10,rx:2,fill:"#64748b",opacity:W==="canvas-top-right"||s?.type==="canvas-top-right"?.9:.4,style:{cursor:"nesw-resize",pointerEvents:"none"}}),e.jsx("rect",{x:-8,y:v.height-8,width:10,height:10,rx:2,fill:"#64748b",opacity:W==="canvas-bottom-left"||s?.type==="canvas-bottom-left"?.9:.4,style:{cursor:"nesw-resize",pointerEvents:"none"}}),e.jsx("rect",{x:v.width-8,y:v.height-8,width:10,height:10,rx:2,fill:"#64748b",opacity:W==="canvas-bottom-right"||s?.type==="canvas-bottom-right"?.9:.4,style:{cursor:"nwse-resize",pointerEvents:"none"}})]}),x&&e.jsx("rect",{x:Math.min(x.startX,x.currentX),y:Math.min(x.startY,x.currentY),width:Math.abs(x.currentX-x.startX),height:Math.abs(x.currentY-x.startY),fill:"rgba(59,130,246,0.08)",stroke:"#3b82f6",strokeWidth:1,strokeDasharray:"4 2",pointerEvents:"none"})]}),e.jsxs("div",{className:"absolute bottom-3 left-3 flex items-center gap-1 rounded-xl border bg-background/90 px-1 py-1 shadow-lg backdrop-blur-sm",children:[e.jsx("button",{className:"flex h-7 w-7 items-center justify-center rounded-lg text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:Yt,title:"Zoom out",children:"âˆ’"}),e.jsxs("button",{className:"flex h-7 min-w-14 items-center justify-center rounded-lg text-xs font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:$t,title:"Reset zoom",children:[Math.round(c*100),"%"]}),e.jsx("button",{className:"flex h-7 w-7 items-center justify-center rounded-lg text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:Ht,title:"Zoom in",children:"+"}),e.jsx("div",{className:"mx-0.5 h-4 w-px bg-border"}),e.jsx("button",{className:"flex h-7 items-center justify-center rounded-lg px-2 text-[10px] font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:Xt,title:"Fit to view",children:"Fit"})]}),e.jsx(Qt,{booth:Ot,onClose:()=>{ue&&k(ue.id)},containerRef:t,viewTransform:{x:a.x,y:a.y,scale:c}})]})}const We=d.forwardRef(({className:t,...o},r)=>e.jsx("textarea",{className:re("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...o}));We.displayName="Textarea";var Te="Switch",[Ks]=at(Te),[Gs,qs]=Ks(Te),ht=d.forwardRef((t,o)=>{const{__scopeSwitch:r,name:i,checked:s,defaultChecked:h,required:x,disabled:u,value:c="on",onCheckedChange:m,form:a,...n}=t,[g,k]=d.useState(null),y=oe(o,$=>k($)),D=d.useRef(!1),B=g?a||!!g.closest("form"):!0,[I,Y]=Ut({prop:s,defaultProp:h??!1,onChange:m,caller:Te});return e.jsxs(Gs,{scope:r,checked:I,disabled:u,children:[e.jsx(de.button,{type:"button",role:"switch","aria-checked":I,"aria-required":x,"data-state":pt(I),"data-disabled":u?"":void 0,disabled:u,value:c,...n,ref:y,onClick:se(t.onClick,$=>{Y(q=>!q),B&&(D.current=$.isPropagationStopped(),D.current||$.stopPropagation())})}),B&&e.jsx(ft,{control:g,bubbles:!D.current,name:i,value:c,checked:I,required:x,disabled:u,form:a,style:{transform:"translateX(-100%)"}})]})});ht.displayName=Te;var xt="SwitchThumb",ut=d.forwardRef((t,o)=>{const{__scopeSwitch:r,...i}=t,s=qs(xt,r);return e.jsx(de.span,{"data-state":pt(s.checked),"data-disabled":s.disabled?"":void 0,...i,ref:o})});ut.displayName=xt;var Zs="SwitchBubbleInput",ft=d.forwardRef(({__scopeSwitch:t,control:o,checked:r,bubbles:i=!0,...s},h)=>{const x=d.useRef(null),u=oe(x,h),c=es(r),m=Vt(o);return d.useEffect(()=>{const a=x.current;if(!a)return;const n=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(n,"checked").set;if(c!==r&&k){const y=new Event("click",{bubbles:i});k.call(a,r),a.dispatchEvent(y)}},[c,r,i]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:u,style:{...s.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ft.displayName=Zs;function pt(t){return t?"checked":"unchecked"}var mt=ht,Js=ut;const te=d.forwardRef(({className:t,...o},r)=>e.jsx(mt,{className:re("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...o,ref:r,children:e.jsx(Js,{className:re("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));te.displayName=mt.displayName;function Qs(t,o){return d.useReducer((r,i)=>o[r][i]??r,t)}var He="ScrollArea",[vt]=at(He),[er,X]=vt(He),gt=d.forwardRef((t,o)=>{const{__scopeScrollArea:r,type:i="hover",dir:s,scrollHideDelay:h=600,...x}=t,[u,c]=d.useState(null),[m,a]=d.useState(null),[n,g]=d.useState(null),[k,y]=d.useState(null),[D,B]=d.useState(null),[I,Y]=d.useState(0),[$,q]=d.useState(0),[ne,Q]=d.useState(!1),[v,A]=d.useState(!1),T=oe(o,L=>c(L)),R=ts(s);return e.jsx(er,{scope:r,type:i,dir:R,scrollHideDelay:h,scrollArea:u,viewport:m,onViewportChange:a,content:n,onContentChange:g,scrollbarX:k,onScrollbarXChange:y,scrollbarXEnabled:ne,onScrollbarXEnabledChange:Q,scrollbarY:D,onScrollbarYChange:B,scrollbarYEnabled:v,onScrollbarYEnabledChange:A,onCornerWidthChange:Y,onCornerHeightChange:q,children:e.jsx(de.div,{dir:R,...x,ref:T,style:{position:"relative","--radix-scroll-area-corner-width":I+"px","--radix-scroll-area-corner-height":$+"px",...t.style}})})});gt.displayName=He;var bt="ScrollAreaViewport",jt=d.forwardRef((t,o)=>{const{__scopeScrollArea:r,children:i,nonce:s,...h}=t,x=X(bt,r),u=d.useRef(null),c=oe(o,u,x.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),e.jsx(de.div,{"data-radix-scroll-area-viewport":"",...h,ref:c,style:{overflowX:x.scrollbarXEnabled?"scroll":"hidden",overflowY:x.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:x.onContentChange,style:{minWidth:"100%",display:"table"},children:i})})]})});jt.displayName=bt;var G="ScrollAreaScrollbar",Ye=d.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=X(G,t.__scopeScrollArea),{onScrollbarXEnabledChange:h,onScrollbarYEnabledChange:x}=s,u=t.orientation==="horizontal";return d.useEffect(()=>(u?h(!0):x(!0),()=>{u?h(!1):x(!1)}),[u,h,x]),s.type==="hover"?e.jsx(tr,{...i,ref:o,forceMount:r}):s.type==="scroll"?e.jsx(sr,{...i,ref:o,forceMount:r}):s.type==="auto"?e.jsx(wt,{...i,ref:o,forceMount:r}):s.type==="always"?e.jsx($e,{...i,ref:o}):null});Ye.displayName=G;var tr=d.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=X(G,t.__scopeScrollArea),[h,x]=d.useState(!1);return d.useEffect(()=>{const u=s.scrollArea;let c=0;if(u){const m=()=>{window.clearTimeout(c),x(!0)},a=()=>{c=window.setTimeout(()=>x(!1),s.scrollHideDelay)};return u.addEventListener("pointerenter",m),u.addEventListener("pointerleave",a),()=>{window.clearTimeout(c),u.removeEventListener("pointerenter",m),u.removeEventListener("pointerleave",a)}}},[s.scrollArea,s.scrollHideDelay]),e.jsx(Ce,{present:r||h,children:e.jsx(wt,{"data-state":h?"visible":"hidden",...i,ref:o})})}),sr=d.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=X(G,t.__scopeScrollArea),h=t.orientation==="horizontal",x=Re(()=>c("SCROLL_END"),100),[u,c]=Qs("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return d.useEffect(()=>{if(u==="idle"){const m=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(m)}},[u,s.scrollHideDelay,c]),d.useEffect(()=>{const m=s.viewport,a=h?"scrollLeft":"scrollTop";if(m){let n=m[a];const g=()=>{const k=m[a];n!==k&&(c("SCROLL"),x()),n=k};return m.addEventListener("scroll",g),()=>m.removeEventListener("scroll",g)}},[s.viewport,h,c,x]),e.jsx(Ce,{present:r||u!=="hidden",children:e.jsx($e,{"data-state":u==="hidden"?"hidden":"visible",...i,ref:o,onPointerEnter:se(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:se(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),wt=d.forwardRef((t,o)=>{const r=X(G,t.__scopeScrollArea),{forceMount:i,...s}=t,[h,x]=d.useState(!1),u=t.orientation==="horizontal",c=Re(()=>{if(r.viewport){const m=r.viewport.offsetWidth<r.viewport.scrollWidth,a=r.viewport.offsetHeight<r.viewport.scrollHeight;x(u?m:a)}},10);return fe(r.viewport,c),fe(r.content,c),e.jsx(Ce,{present:i||h,children:e.jsx($e,{"data-state":h?"visible":"hidden",...s,ref:o})})}),$e=d.forwardRef((t,o)=>{const{orientation:r="vertical",...i}=t,s=X(G,t.__scopeScrollArea),h=d.useRef(null),x=d.useRef(0),[u,c]=d.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),m=St(u.viewport,u.content),a={...i,sizes:u,onSizesChange:c,hasThumb:m>0&&m<1,onThumbChange:g=>h.current=g,onThumbPointerUp:()=>x.current=0,onThumbPointerDown:g=>x.current=g};function n(g,k){return lr(g,x.current,u,k)}return r==="horizontal"?e.jsx(rr,{...a,ref:o,onThumbPositionChange:()=>{if(s.viewport&&h.current){const g=s.viewport.scrollLeft,k=ot(g,u,s.dir);h.current.style.transform=`translate3d(${k}px, 0, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollLeft=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollLeft=n(g,s.dir))}}):r==="vertical"?e.jsx(or,{...a,ref:o,onThumbPositionChange:()=>{if(s.viewport&&h.current){const g=s.viewport.scrollTop,k=ot(g,u);h.current.style.transform=`translate3d(0, ${k}px, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollTop=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollTop=n(g))}}):null}),rr=d.forwardRef((t,o)=>{const{sizes:r,onSizesChange:i,...s}=t,h=X(G,t.__scopeScrollArea),[x,u]=d.useState(),c=d.useRef(null),m=oe(o,c,h.onScrollbarXChange);return d.useEffect(()=>{c.current&&u(getComputedStyle(c.current))},[c]),e.jsx(Ct,{"data-orientation":"horizontal",...s,ref:m,sizes:r,style:{bottom:0,left:h.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:h.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Pe(r)+"px",...t.style},onThumbPointerDown:a=>t.onThumbPointerDown(a.x),onDragScroll:a=>t.onDragScroll(a.x),onWheelScroll:(a,n)=>{if(h.viewport){const g=h.viewport.scrollLeft+a.deltaX;t.onWheelScroll(g),Tt(g,n)&&a.preventDefault()}},onResize:()=>{c.current&&h.viewport&&x&&i({content:h.viewport.scrollWidth,viewport:h.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:ye(x.paddingLeft),paddingEnd:ye(x.paddingRight)}})}})}),or=d.forwardRef((t,o)=>{const{sizes:r,onSizesChange:i,...s}=t,h=X(G,t.__scopeScrollArea),[x,u]=d.useState(),c=d.useRef(null),m=oe(o,c,h.onScrollbarYChange);return d.useEffect(()=>{c.current&&u(getComputedStyle(c.current))},[c]),e.jsx(Ct,{"data-orientation":"vertical",...s,ref:m,sizes:r,style:{top:0,right:h.dir==="ltr"?0:void 0,left:h.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Pe(r)+"px",...t.style},onThumbPointerDown:a=>t.onThumbPointerDown(a.y),onDragScroll:a=>t.onDragScroll(a.y),onWheelScroll:(a,n)=>{if(h.viewport){const g=h.viewport.scrollTop+a.deltaY;t.onWheelScroll(g),Tt(g,n)&&a.preventDefault()}},onResize:()=>{c.current&&h.viewport&&x&&i({content:h.viewport.scrollHeight,viewport:h.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:ye(x.paddingTop),paddingEnd:ye(x.paddingBottom)}})}})}),[nr,yt]=vt(G),Ct=d.forwardRef((t,o)=>{const{__scopeScrollArea:r,sizes:i,hasThumb:s,onThumbChange:h,onThumbPointerUp:x,onThumbPointerDown:u,onThumbPositionChange:c,onDragScroll:m,onWheelScroll:a,onResize:n,...g}=t,k=X(G,r),[y,D]=d.useState(null),B=oe(o,T=>D(T)),I=d.useRef(null),Y=d.useRef(""),$=k.viewport,q=i.content-i.viewport,ne=ie(a),Q=ie(c),v=Re(n,10);function A(T){if(I.current){const R=T.clientX-I.current.left,L=T.clientY-I.current.top;m({x:R,y:L})}}return d.useEffect(()=>{const T=R=>{const L=R.target;y?.contains(L)&&ne(R,q)};return document.addEventListener("wheel",T,{passive:!1}),()=>document.removeEventListener("wheel",T,{passive:!1})},[$,y,q,ne]),d.useEffect(Q,[i,Q]),fe(y,v),fe(k.content,v),e.jsx(nr,{scope:r,scrollbar:y,hasThumb:s,onThumbChange:ie(h),onThumbPointerUp:ie(x),onThumbPositionChange:Q,onThumbPointerDown:ie(u),children:e.jsx(de.div,{...g,ref:B,style:{position:"absolute",...g.style},onPointerDown:se(t.onPointerDown,T=>{T.button===0&&(T.target.setPointerCapture(T.pointerId),I.current=y.getBoundingClientRect(),Y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",k.viewport&&(k.viewport.style.scrollBehavior="auto"),A(T))}),onPointerMove:se(t.onPointerMove,A),onPointerUp:se(t.onPointerUp,T=>{const R=T.target;R.hasPointerCapture(T.pointerId)&&R.releasePointerCapture(T.pointerId),document.body.style.webkitUserSelect=Y.current,k.viewport&&(k.viewport.style.scrollBehavior=""),I.current=null})})})}),we="ScrollAreaThumb",Nt=d.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=yt(we,t.__scopeScrollArea);return e.jsx(Ce,{present:r||s.hasThumb,children:e.jsx(ar,{ref:o,...i})})}),ar=d.forwardRef((t,o)=>{const{__scopeScrollArea:r,style:i,...s}=t,h=X(we,r),x=yt(we,r),{onThumbPositionChange:u}=x,c=oe(o,n=>x.onThumbChange(n)),m=d.useRef(void 0),a=Re(()=>{m.current&&(m.current(),m.current=void 0)},100);return d.useEffect(()=>{const n=h.viewport;if(n){const g=()=>{if(a(),!m.current){const k=cr(n,u);m.current=k,u()}};return u(),n.addEventListener("scroll",g),()=>n.removeEventListener("scroll",g)}},[h.viewport,a,u]),e.jsx(de.div,{"data-state":x.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:se(t.onPointerDownCapture,n=>{const k=n.target.getBoundingClientRect(),y=n.clientX-k.left,D=n.clientY-k.top;x.onThumbPointerDown({x:y,y:D})}),onPointerUp:se(t.onPointerUp,x.onThumbPointerUp)})});Nt.displayName=we;var Xe="ScrollAreaCorner",kt=d.forwardRef((t,o)=>{const r=X(Xe,t.__scopeScrollArea),i=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&i?e.jsx(ir,{...t,ref:o}):null});kt.displayName=Xe;var ir=d.forwardRef((t,o)=>{const{__scopeScrollArea:r,...i}=t,s=X(Xe,r),[h,x]=d.useState(0),[u,c]=d.useState(0),m=!!(h&&u);return fe(s.scrollbarX,()=>{const a=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(a),c(a)}),fe(s.scrollbarY,()=>{const a=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(a),x(a)}),m?e.jsx(de.div,{...i,ref:o,style:{width:h,height:u,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function ye(t){return t?parseInt(t,10):0}function St(t,o){const r=t/o;return isNaN(r)?0:r}function Pe(t){const o=St(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=(t.scrollbar.size-r)*o;return Math.max(i,18)}function lr(t,o,r,i="ltr"){const s=Pe(r),h=s/2,x=o||h,u=s-x,c=r.scrollbar.paddingStart+x,m=r.scrollbar.size-r.scrollbar.paddingEnd-u,a=r.content-r.viewport,n=i==="ltr"?[0,a]:[a*-1,0];return Et([c,m],n)(t)}function ot(t,o,r="ltr"){const i=Pe(o),s=o.scrollbar.paddingStart+o.scrollbar.paddingEnd,h=o.scrollbar.size-s,x=o.content-o.viewport,u=h-i,c=r==="ltr"?[0,x]:[x*-1,0],m=ss(t,c);return Et([0,x],[0,u])(m)}function Et(t,o){return r=>{if(t[0]===t[1]||o[0]===o[1])return o[0];const i=(o[1]-o[0])/(t[1]-t[0]);return o[0]+i*(r-t[0])}}function Tt(t,o){return t>0&&t<o}var cr=(t,o=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},i=0;return(function s(){const h={left:t.scrollLeft,top:t.scrollTop},x=r.left!==h.left,u=r.top!==h.top;(x||u)&&o(),r=h,i=window.requestAnimationFrame(s)})(),()=>window.cancelAnimationFrame(i)};function Re(t,o){const r=ie(t),i=d.useRef(0);return d.useEffect(()=>()=>window.clearTimeout(i.current),[]),d.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(r,o)},[r,o])}function fe(t,o){const r=ie(o);Ft(()=>{let i=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(r)});return s.observe(t),()=>{window.cancelAnimationFrame(i),s.unobserve(t)}}},[t,r])}var Pt=gt,dr=jt,hr=kt;const Oe=d.forwardRef(({className:t,children:o,...r},i)=>e.jsxs(Pt,{ref:i,className:re("relative overflow-hidden",t),...r,children:[e.jsx(dr,{className:"h-full w-full rounded-[inherit]",children:o}),e.jsx(Rt,{}),e.jsx(hr,{})]}));Oe.displayName=Pt.displayName;const Rt=d.forwardRef(({className:t,orientation:o="vertical",...r},i)=>e.jsx(Ye,{ref:i,orientation:o,className:re("flex touch-none select-none transition-colors",o==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",o==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:e.jsx(Nt,{className:"relative flex-1 rounded-full bg-border"})}));Rt.displayName=Ye.displayName;var xr=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ur=xr.reduce((t,o)=>{const r=Kt(`Primitive.${o}`),i=d.forwardRef((s,h)=>{const{asChild:x,...u}=s,c=x?r:o;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(c,{...u,ref:h})});return i.displayName=`Primitive.${o}`,{...t,[o]:i}},{}),fr="Separator",nt="horizontal",pr=["horizontal","vertical"],Mt=d.forwardRef((t,o)=>{const{decorative:r,orientation:i=nt,...s}=t,h=mr(i)?i:nt,u=r?{role:"none"}:{"aria-orientation":h==="vertical"?h:void 0,role:"separator"};return e.jsx(ur.div,{"data-orientation":h,...u,...s,ref:o})});Mt.displayName=fr;function mr(t){return pr.includes(t)}var At=Mt;const H=d.forwardRef(({className:t,orientation:o="horizontal",decorative:r=!0,...i},s)=>e.jsx(At,{ref:s,decorative:r,orientation:o,className:re("shrink-0 bg-border",o==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...i}));H.displayName=At.displayName;function Me({children:t}){return e.jsx("h3",{className:"mb-2 text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:t})}function N({label:t,children:o}){return e.jsxs("div",{className:"grid grid-cols-[1fr_1fr] items-center gap-2",children:[e.jsx(P,{className:"text-xs",children:t}),o]})}function vr({element:t}){const[o,r]=d.useState(!0),[i,s]=d.useState(!1),h=p(n=>n.updateElement),x=p(n=>n.removeElement),u=p(n=>n.setStartingPoint),c=p(n=>n.duplicateElements),m=p(n=>n.venue.tiers);d.useEffect(()=>{r(!0),s(!1)},[t.id]);const a=n=>h(t.id,{...n,popupConfigured:!0});return e.jsxs("div",{className:"space-y-2.5",children:[e.jsx(N,{label:"Name",children:e.jsx(w,{value:t.name,onChange:n=>h(t.id,{name:n.target.value}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Booth #",children:e.jsx(w,{value:t.boothNumber,onChange:n=>h(t.id,{boothNumber:n.target.value}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Tier",children:e.jsxs(Ne,{value:t.tierId??"",onValueChange:n=>h(t.id,{tierId:n}),children:[e.jsx(ke,{className:"h-8 text-xs",children:e.jsx(Se,{placeholder:"Assign tier"})}),e.jsx(Ee,{children:m.map(n=>e.jsx(le,{value:n.id,className:"text-xs",children:n.name},n.id))})]})}),e.jsxs("div",{className:"rounded-md border border-border/70 p-2.5 space-y-2",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between",onClick:()=>{s(n=>!n),a({})},children:[e.jsx(P,{className:"cursor-pointer text-xs font-medium",children:"Popup Appearance"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:i?"Hide":"Show"})]}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-md border border-border/60 p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{className:"text-xs",children:"Show Description"}),e.jsx(te,{checked:t.showDescription,onCheckedChange:n=>a({showDescription:n})})]}),t.showDescription&&e.jsx(We,{value:t.description??"",onChange:n=>a({description:n.target.value}),className:"min-h-[60px] text-xs",rows:3})]}),e.jsxs("div",{className:"rounded-md border border-border/60 p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{className:"text-xs",children:"Visit Website"}),e.jsx(te,{checked:t.showWebsiteCTA,onCheckedChange:n=>a({showWebsiteCTA:n})})]}),t.showWebsiteCTA&&e.jsxs(e.Fragment,{children:[e.jsx(w,{value:t.websiteUrl??"",onChange:n=>a({websiteUrl:n.target.value}),placeholder:"https://...",className:"h-8 text-xs"}),e.jsx(N,{label:"Text",children:e.jsx(w,{value:t.websiteCtaText??"Visit website",onChange:n=>a({websiteCtaText:n.target.value}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Color",children:e.jsx(w,{type:"color",value:t.websiteCtaButtonColor??"#111827",onChange:n=>a({websiteCtaButtonColor:n.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Text Color",children:e.jsx(w,{type:"color",value:t.websiteCtaTextColor??"#ffffff",onChange:n=>a({websiteCtaTextColor:n.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Radius",children:e.jsx(w,{type:"number",min:0,max:24,value:t.websiteCtaRadius??10,onChange:n=>a({websiteCtaRadius:Number(n.target.value)}),className:"h-8 text-xs"})})]})]}),[{title:"Mark as Visited",show:t.showVisitedCTA,setShow:n=>a({showVisitedCTA:n}),text:t.visitedCtaText??"Mark as visited",setText:n=>a({visitedCtaText:n}),color:t.visitedCtaButtonColor??"#111827",setColor:n=>a({visitedCtaButtonColor:n}),textColor:t.visitedCtaTextColor??"#ffffff",setTextColor:n=>a({visitedCtaTextColor:n}),radius:t.visitedCtaRadius??10,setRadius:n=>a({visitedCtaRadius:n})},{title:"Mark as Favorite",show:t.showFavoriteCTA,setShow:n=>a({showFavoriteCTA:n}),text:t.favoriteCtaText??"Mark as favorite",setText:n=>a({favoriteCtaText:n}),color:t.favoriteCtaButtonColor??"#111827",setColor:n=>a({favoriteCtaButtonColor:n}),textColor:t.favoriteCtaTextColor??"#ffffff",setTextColor:n=>a({favoriteCtaTextColor:n}),radius:t.favoriteCtaRadius??10,setRadius:n=>a({favoriteCtaRadius:n})},{title:"Rate (5 star)",show:t.showRateCTA,setShow:n=>a({showRateCTA:n}),text:t.rateCtaText??"Rate",setText:n=>a({rateCtaText:n}),color:t.rateCtaButtonColor??"#111827",setColor:n=>a({rateCtaButtonColor:n}),textColor:t.rateCtaTextColor??"#ffffff",setTextColor:n=>a({rateCtaTextColor:n}),radius:t.rateCtaRadius??10,setRadius:n=>a({rateCtaRadius:n})},{title:"Get Direction",show:t.showDirectionCTA,setShow:n=>a({showDirectionCTA:n}),text:t.directionCtaText??"Get direction",setText:n=>a({directionCtaText:n}),color:t.directionCtaButtonColor??"#111827",setColor:n=>a({directionCtaButtonColor:n}),textColor:t.directionCtaTextColor??"#ffffff",setTextColor:n=>a({directionCtaTextColor:n}),radius:t.directionCtaRadius??10,setRadius:n=>a({directionCtaRadius:n})}].map(n=>e.jsxs("div",{className:"rounded-md border border-border/60 p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{className:"text-xs",children:n.title}),e.jsx(te,{checked:n.show,onCheckedChange:n.setShow})]}),n.show&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:"Text",children:e.jsx(w,{value:n.text,onChange:g=>n.setText(g.target.value),className:"h-8 text-xs"})}),e.jsx(N,{label:"Color",children:e.jsx(w,{type:"color",value:n.color,onChange:g=>n.setColor(g.target.value),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Text Color",children:e.jsx(w,{type:"color",value:n.textColor,onChange:g=>n.setTextColor(g.target.value),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Radius",children:e.jsx(w,{type:"number",min:0,max:24,value:n.radius,onChange:g=>n.setRadius(Number(g.target.value)),className:"h-8 text-xs"})})]})]},n.title))]})]}),e.jsxs("div",{className:"rounded-md border border-border/70 p-2.5 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{className:"text-xs font-medium",children:"Booth Appearance"}),e.jsx(te,{checked:o,onCheckedChange:r})]}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Logo URL"}),e.jsx(w,{value:t.logoUrl??"",onChange:n=>h(t.id,{logoUrl:n.target.value||void 0}),placeholder:"https://example.com/logo.png",className:"h-8 text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border/60 px-2",children:[e.jsx(P,{className:"text-xs",children:"Fill"}),e.jsx(te,{checked:t.fillEnabled!==!1,onCheckedChange:n=>h(t.id,{fillEnabled:n})})]}),e.jsx(w,{type:"color",value:t.fillColor??"#3b82f6",disabled:t.fillEnabled===!1,onChange:n=>h(t.id,{fillColor:n.target.value}),className:"h-8 cursor-pointer p-1 disabled:cursor-not-allowed"})]}),e.jsx(N,{label:"Border Color",children:e.jsx(w,{type:"color",value:t.borderColor??"#1f2937",onChange:n=>h(t.id,{borderColor:n.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Border Width",children:e.jsx(w,{type:"number",min:0,max:12,value:t.borderWidth??1,onChange:n=>h(t.id,{borderWidth:Number(n.target.value)}),className:"h-8 text-xs"})}),t.shape==="square"&&e.jsx(N,{label:"Radius",children:e.jsx(w,{type:"number",min:0,max:Math.min(t.width,t.height)/2,value:t.borderRadius??10,onChange:n=>h(t.id,{borderRadius:Number(n.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Text Color",children:e.jsx(w,{type:"color",value:t.textColor,onChange:n=>h(t.id,{textColor:n.target.value}),className:"h-8 cursor-pointer p-1"})})]})]}),e.jsx(H,{}),e.jsx(Me,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Width"}),e.jsx(w,{type:"number",value:t.width,onChange:n=>h(t.id,{width:Number(n.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Height"}),e.jsx(w,{type:"number",value:t.height,onChange:n=>h(t.id,{height:Number(n.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Rotation"}),e.jsx(w,{type:"number",value:t.rotation,onChange:n=>h(t.id,{rotation:Number(n.target.value)}),className:"h-8 text-xs"})]})]}),e.jsx(N,{label:"X Position",children:e.jsx(w,{type:"number",value:Math.round(t.x),onChange:n=>h(t.id,{x:Number(n.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Y Position",children:e.jsx(w,{type:"number",value:Math.round(t.y),onChange:n=>h(t.id,{y:Number(n.target.value)}),className:"h-8 text-xs"})}),e.jsx(H,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>u(t.id),children:[e.jsx(Be,{className:"mr-1 h-3 w-3"})," Set Start"]}),e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>c([t.id]),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Duplicate"]})]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"w-full text-xs",onClick:()=>x(t.id),children:[e.jsx(he,{className:"mr-1 h-3 w-3"})," Delete"]})]})}function gr({element:t}){const o=p(s=>s.updateElement),r=p(s=>s.removeElement),i=p(s=>s.duplicateElements);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Text Content"}),e.jsx(We,{value:t.text,onChange:s=>o(t.id,{text:s.target.value}),className:"mt-1 min-h-[60px] text-xs",rows:3})]}),e.jsx(N,{label:"Font Size",children:e.jsx(w,{type:"number",value:t.fontSize,min:8,onChange:s=>o(t.id,{fontSize:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Font Weight",children:e.jsxs(Ne,{value:t.fontWeight,onValueChange:s=>o(t.id,{fontWeight:s}),children:[e.jsx(ke,{className:"h-8 text-xs",children:e.jsx(Se,{})}),e.jsxs(Ee,{children:[e.jsx(le,{value:"normal",children:"Normal"}),e.jsx(le,{value:"bold",children:"Bold"})]})]})}),e.jsx(N,{label:"Fill Color",children:e.jsx(w,{type:"color",value:t.fillColor==="transparent"?"#ffffff":t.fillColor,onChange:s=>o(t.id,{fillColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Text Color",children:e.jsx(w,{type:"color",value:t.textColor,onChange:s=>o(t.id,{textColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(H,{}),e.jsx(Me,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Width"}),e.jsx(w,{type:"number",value:t.width,onChange:s=>o(t.id,{width:Number(s.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Height"}),e.jsx(w,{type:"number",value:t.height,onChange:s=>o(t.id,{height:Number(s.target.value)}),className:"h-8 text-xs"})]})]}),e.jsx(N,{label:"Rotation",children:e.jsx(w,{type:"number",value:t.rotation,onChange:s=>o(t.id,{rotation:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(H,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i([t.id]),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(t.id),children:[e.jsx(he,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})}function br({element:t}){const o=p(s=>s.updateElement),r=p(s=>s.removeElement),i=p(s=>s.duplicateElements);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Image URL"}),e.jsx(w,{value:t.imageUrl,onChange:s=>o(t.id,{imageUrl:s.target.value}),placeholder:"https://...",className:"h-8 text-xs"})]}),e.jsx(N,{label:"Opacity",children:e.jsx("input",{type:"range",min:0,max:1,step:.05,value:t.opacity,onChange:s=>o(t.id,{opacity:Number(s.target.value)}),className:"w-full"})}),e.jsx(H,{}),e.jsx(Me,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Width"}),e.jsx(w,{type:"number",value:t.width,onChange:s=>o(t.id,{width:Number(s.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Height"}),e.jsx(w,{type:"number",value:t.height,onChange:s=>o(t.id,{height:Number(s.target.value)}),className:"h-8 text-xs"})]})]}),e.jsx(N,{label:"Rotation",children:e.jsx(w,{type:"number",value:t.rotation,onChange:s=>o(t.id,{rotation:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(H,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i([t.id]),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(t.id),children:[e.jsx(he,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})}function jr({element:t}){const o=p(s=>s.updateElement),r=p(s=>s.removeElement),i=p(s=>s.duplicateElements);return e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{label:"Type",children:e.jsxs(Ne,{value:t.connectorType,onValueChange:s=>o(t.id,{connectorType:s}),children:[e.jsx(ke,{className:"h-8 text-xs",children:e.jsx(Se,{})}),e.jsxs(Ee,{children:[e.jsx(le,{value:"directional",children:"Directional"}),e.jsx(le,{value:"bidirectional",children:"Bidirectional"}),e.jsx(le,{value:"polyline",children:"Polyline"})]})]})}),e.jsx(N,{label:"Stroke Color",children:e.jsx(w,{type:"color",value:t.strokeColor,onChange:s=>o(t.id,{strokeColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Stroke Width",children:e.jsx(w,{type:"number",value:t.strokeWidth,min:1,max:20,onChange:s=>o(t.id,{strokeWidth:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(H,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i([t.id]),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(t.id),children:[e.jsx(he,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})}function wr({elements:t}){const o=p(a=>a.updateElements),r=p(a=>a.removeElements),i=p(a=>a.duplicateElements),s=t.map(a=>a.id),h=t.every(a=>"width"in a&&"height"in a),x=t.every(a=>"x"in a&&"y"in a),u=t.every(a=>"rotation"in a),c=t.every(a=>"fillColor"in a),m=t.every(a=>"textColor"in a);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-md bg-muted/50 p-2",children:[e.jsxs("p",{className:"text-xs font-medium",children:[t.length," elements selected"]}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Editing shared properties will apply to all selected elements."})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(Me,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Width"}),e.jsx(w,{type:"number",placeholder:"mixed",onChange:a=>{const n=Number(a.target.value);n>0&&o(s,{width:n})},className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Height"}),e.jsx(w,{type:"number",placeholder:"mixed",onChange:a=>{const n=Number(a.target.value);n>0&&o(s,{height:n})},className:"h-8 text-xs"})]})]})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:"X Position",children:e.jsx(w,{type:"number",placeholder:"mixed",onChange:a=>o(s,{x:Number(a.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Y Position",children:e.jsx(w,{type:"number",placeholder:"mixed",onChange:a=>o(s,{y:Number(a.target.value)}),className:"h-8 text-xs"})})]}),u&&e.jsx(N,{label:"Rotation",children:e.jsx(w,{type:"number",placeholder:"mixed",onChange:a=>o(s,{rotation:Number(a.target.value)}),className:"h-8 text-xs"})}),c&&e.jsx(N,{label:"Fill Color",children:e.jsx(w,{type:"color",onChange:a=>o(s,{fillColor:a.target.value}),className:"h-8 cursor-pointer p-1"})}),m&&e.jsx(N,{label:"Text Color",children:e.jsx(w,{type:"color",onChange:a=>o(s,{textColor:a.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(H,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i(s),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(s),children:[e.jsx(he,{className:"mr-1 h-3 w-3"})," Delete All"]})]})]})}function yr({element:t,elements:o}){const r=p(i=>i.setSelectedElement);return e.jsxs("div",{className:"mb-3",children:[e.jsx(P,{className:"text-xs",children:"Selected Element"}),e.jsxs(Ne,{value:t.id,onValueChange:i=>r(i),children:[e.jsx(ke,{className:"mt-1 h-8 text-xs",children:e.jsx(Se,{})}),e.jsx(Ee,{children:o.map(i=>e.jsx(le,{value:i.id,className:"text-xs",children:i.type==="booth"?`${i.name} (#${i.boothNumber})`:i.type==="text"?i.text.slice(0,25):i.type==="image"?"Image":`Connector (${i.connectorType})`},i.id))})]})]})}function Cr(){return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 py-12 text-center",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-muted",children:e.jsx(Ss,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"No element selected"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Click an element on the canvas or select from the elements list."})]})]})}function Nr(){const t=p(x=>x.selectedElementIds),o=p(x=>x.elements),r=t.map(x=>o.find(u=>u.id===x)).filter(Boolean),i=r.length>1,s=r.length===1?r[0]:null,h=i?`${r.length} Elements`:s?`${s.type.charAt(0).toUpperCase()+s.type.slice(1)} Properties`:"Properties";return e.jsxs("aside",{className:"flex w-72 flex-col border-r border-border bg-background [&_button]:text-[12px] [&_h2]:text-[12px] [&_h3]:text-[12px] [&_input]:text-[12px] [&_label]:text-[12px] [&_p]:text-[12px] [&_span]:text-[12px] [&_textarea]:text-[12px]",children:[e.jsx("div",{className:"flex h-10 shrink-0 items-center border-b border-border px-4",children:e.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:h})}),e.jsx(Oe,{className:"flex-1",children:e.jsxs("div",{className:"p-4",children:[i&&e.jsx(wr,{elements:r}),s&&e.jsxs(e.Fragment,{children:[e.jsx(yr,{element:s,elements:o}),s.type==="booth"&&e.jsx(vr,{element:s}),s.type==="text"&&e.jsx(gr,{element:s}),s.type==="image"&&e.jsx(br,{element:s}),s.type==="connector"&&e.jsx(jr,{element:s})]}),r.length===0&&e.jsx(Cr,{})]})})]})}const kr=[{tool:"select",icon:e.jsx(Ns,{className:"h-4 w-4"}),label:"Select"},{tool:"booth-circle",icon:e.jsx(ds,{className:"h-4 w-4"}),label:"Circle Booth"},{tool:"booth-square",icon:e.jsx(ct,{className:"h-4 w-4"}),label:"Square Booth"},{tool:"text",icon:e.jsx(dt,{className:"h-4 w-4"}),label:"Text"},{tool:"image",icon:e.jsx(it,{className:"h-4 w-4"}),label:"Image"},{tool:"connector-directional",icon:e.jsx(ls,{className:"h-4 w-4"}),label:"Directional"},{tool:"connector-bidirectional",icon:e.jsx(as,{className:"h-4 w-4"}),label:"Bidirectional"},{tool:"connector-polyline",icon:e.jsx(lt,{className:"h-4 w-4"}),label:"Polyline"}];function ve({children:t}){return e.jsx("h3",{className:"mb-2 text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:t})}function Sr({label:t,children:o}){return e.jsxs("div",{className:"grid grid-cols-[1fr_1fr] items-center gap-2",children:[e.jsx(P,{className:"text-xs",children:t}),o]})}function Er(){const t=p(r=>r.activeTool),o=p(r=>r.setActiveTool);return e.jsxs("div",{children:[e.jsx(ve,{children:"Tools"}),e.jsx(Ie,{delayDuration:200,children:e.jsx("div",{className:"grid grid-cols-5 gap-1",children:kr.map(({tool:r,icon:i,label:s})=>e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:t===r?"default":"outline",size:"icon",className:re("h-9 w-9",t===r&&"ring-2 ring-primary/30"),onClick:()=>o(r),children:i})}),e.jsx(K,{side:"bottom",children:s})]},r))})})]})}const Tr={booth:e.jsx(ct,{className:"h-3.5 w-3.5 text-blue-500"}),text:e.jsx(dt,{className:"h-3.5 w-3.5 text-amber-500"}),image:e.jsx(it,{className:"h-3.5 w-3.5 text-emerald-500"}),connector:e.jsx(lt,{className:"h-3.5 w-3.5 text-purple-500"})};function Pr(t){switch(t.type){case"booth":return`${t.name} (#${t.boothNumber})`;case"text":return t.text.length>20?t.text.slice(0,20)+"â€¦":t.text;case"image":return"Image";case"connector":return`Connector (${t.connectorType})`}}function Rr(){const t=p(c=>c.elements),o=p(c=>c.selectedElementIds),r=p(c=>c.setSelectedElement),i=p(c=>c.toggleSelectedElement),s=p(c=>c.duplicateElements),h=p(c=>c.removeElements),x=p(c=>c.removeElement),u=d.useCallback((c,m)=>{m.ctrlKey||m.metaKey||m.shiftKey?i(c):r(c)},[r,i]);return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx(ve,{children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(js,{className:"h-3 w-3"}),"Elements (",t.length,")"]})}),o.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>s(o),children:e.jsx(ce,{className:"h-3 w-3"})})}),e.jsx(K,{side:"bottom",children:"Duplicate selected"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive",onClick:()=>{o.length>1?h(o):x(o[0])},children:e.jsx(he,{className:"h-3 w-3"})})}),e.jsx(K,{side:"bottom",children:"Delete selected"})]})]})]}),t.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"No elements yet. Use tools above to add."}):e.jsx("div",{className:"space-y-0.5 max-h-48 overflow-y-auto",children:t.map(c=>{const m=o.includes(c.id);return e.jsxs("div",{className:re("flex items-center gap-2 rounded-md px-2 py-1.5 text-xs cursor-pointer transition-colors",m?"bg-primary/10 text-primary ring-1 ring-primary/20":"hover:bg-muted/80 text-foreground"),onClick:a=>u(c.id,a),children:[Tr[c.type],e.jsx("span",{className:"flex-1 truncate",children:Pr(c)}),c.type==="booth"&&c.isStartingPoint&&e.jsx(Be,{className:"h-3 w-3 text-red-500 shrink-0"}),e.jsx(M,{variant:"ghost",size:"icon",className:"h-5 w-5 shrink-0 opacity-0 group-hover:opacity-100 hover:opacity-100",style:{opacity:m?.7:void 0},onClick:a=>{a.stopPropagation(),s([c.id])},children:e.jsx(ce,{className:"h-2.5 w-2.5"})})]},c.id)})}),o.length>1&&e.jsxs("p",{className:"mt-1.5 text-[10px] text-muted-foreground",children:[o.length," elements selected â€” Ctrl/Shift+click to multi-select"]})]})}function Mr(){const t=p(r=>r.venue),o=p(r=>r.setVenue);return e.jsxs("div",{className:"space-y-3",children:[e.jsx(ve,{children:"Canvas Settings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Width"}),e.jsx(w,{type:"number",value:t.width,onChange:r=>o({width:Number(r.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Height"}),e.jsx(w,{type:"number",value:t.height,onChange:r=>o({height:Number(r.target.value)}),className:"h-8 text-xs"})]})]}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Grid Size"}),e.jsx(w,{type:"number",value:t.gridSize,min:5,onChange:r=>o({gridSize:Number(r.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{className:"text-xs",children:"Show Grid"}),e.jsx(te,{checked:t.showGrid,onCheckedChange:r=>o({showGrid:r})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{className:"text-xs",children:"Snap to Grid"}),e.jsx(te,{checked:t.snapToGrid,onCheckedChange:r=>o({snapToGrid:r})})]}),e.jsx(Sr,{label:"Background",children:e.jsx(w,{type:"color",value:t.backgroundColor,onChange:r=>o({backgroundColor:r.target.value}),className:"h-8 w-full cursor-pointer p-1"})}),e.jsxs("div",{children:[e.jsx(P,{className:"text-xs",children:"Background Image URL"}),e.jsx(w,{value:t.backgroundImage??"",onChange:r=>o({backgroundImage:r.target.value||void 0}),placeholder:"https://...",className:"h-8 text-xs"})]})]})}function Ar(){const t=p(s=>s.venue.tiers),o=p(s=>s.addTier),r=p(s=>s.updateTier),i=p(s=>s.removeTier);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[e.jsx(ve,{children:"Booth Tiers"}),e.jsxs(M,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs",onClick:o,children:[e.jsx(Ts,{className:"mr-1 h-3 w-3"}),"Add"]})]}),e.jsx("div",{className:"space-y-1.5",children:t.map((s,h)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(w,{value:s.name,onChange:x=>r(s.id,x.target.value),className:"h-8 text-xs",placeholder:`Tier ${h+1}`}),e.jsx(M,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",disabled:t.length<=1,onClick:()=>i(s.id),title:t.length<=1?"Keep at least one tier":"Delete tier",children:e.jsx(he,{className:"h-3.5 w-3.5"})})]},s.id))}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Defaults: Diamond, Gold, Silver. Rename freely."})]})}function _r(){const{projectName:t=""}=Gt(),o=d.useRef(null),r=p(y=>y.getConfig),i=p(y=>y.loadConfig),s=p(y=>y.resetAll),h=p(y=>y.setPreviewMode),x=p(y=>y.setPreviewAsKiosk),u=p(y=>y.undo),c=p(y=>y.redo),m=p(y=>y.past.length>0),a=p(y=>y.future.length>0),n=d.useCallback(async()=>{const y=r(),D=t.trim().toLowerCase();if(!D){alert("Missing project name in route. Open via /admin/:projectName.");return}qt(D,y);try{await Zt(D,y)}catch(B){console.error(B),alert("Failed to save manifest file.")}},[r,t]),g=d.useCallback(y=>{const D=y.target.files?.[0];if(!D)return;const B=new FileReader;B.onload=()=>{try{const I=JSON.parse(B.result);i(I)}catch{alert("Invalid JSON file")}},B.readAsText(D),y.target.value=""},[i]),k=d.useCallback(()=>{window.confirm("Reset all elements, paths, and settings? This cannot be undone.")&&s()},[s]);return e.jsx(Ie,{delayDuration:200,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:u,disabled:!m,"aria-label":"Undo",children:e.jsx(Bs,{className:"h-3.5 w-3.5"})})}),e.jsx(K,{children:"Undo"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:c,disabled:!a,"aria-label":"Redo",children:e.jsx(Rs,{className:"h-3.5 w-3.5"})})}),e.jsx(K,{children:"Redo"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{x(!1),h(!0)},"aria-label":"Preview user mode",children:e.jsx(ps,{className:"h-3.5 w-3.5"})})}),e.jsx(K,{children:"Preview (User)"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{x(!0),h(!0)},"aria-label":"Preview kiosk mode",children:e.jsx(ys,{className:"h-3.5 w-3.5"})})}),e.jsx(K,{children:"Preview (Kiosk)"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{n()},"aria-label":"Save venue",children:e.jsx(us,{className:"h-3.5 w-3.5"})})}),e.jsx(K,{children:"Save Venue"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>o.current?.click(),"aria-label":"Import manifest",children:e.jsx(Hs,{className:"h-3.5 w-3.5"})})}),e.jsx(K,{children:"Import"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(M,{variant:"destructive",size:"icon",className:"h-8 w-8 text-white",onClick:k,"aria-label":"Reset all",children:e.jsx(As,{className:"h-3.5 w-3.5"})})}),e.jsx(K,{children:"Reset All"})]}),e.jsx("input",{ref:o,type:"file",accept:".json",className:"hidden",onChange:g})]})})}function zr(){const t=p(r=>r.activityHistory),o=d.useMemo(()=>t.slice(0,10),[t]);return e.jsxs("div",{children:[e.jsx(ve,{children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(vs,{className:"h-3 w-3"}),"Activity History"]})}),o.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"No activity yet."}):e.jsx("div",{className:"max-h-36 space-y-1 overflow-y-auto rounded-md border border-border/60 p-2",children:o.map(r=>e.jsxs("div",{className:"flex items-center justify-between gap-2 text-[11px]",children:[e.jsx("span",{className:"truncate text-foreground",children:r.label}),e.jsx("span",{className:"shrink-0 text-muted-foreground",children:new Date(r.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},r.id))})]})}function Dr(){return e.jsxs("aside",{className:"flex w-72 flex-col border-l border-border bg-background [&_button]:text-[12px] [&_h2]:text-[12px] [&_h3]:text-[12px] [&_input]:text-[12px] [&_label]:text-[12px] [&_p]:text-[12px] [&_span]:text-[12px]",children:[e.jsx("div",{className:"shrink-0 border-b border-border px-4 py-2",children:e.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:"Elements & Canvas"})}),e.jsx(Oe,{className:"flex-1",children:e.jsxs("div",{className:"space-y-5 p-4",children:[e.jsx(Er,{}),e.jsx(H,{}),e.jsx(Ie,{delayDuration:200,children:e.jsx(Rr,{})}),e.jsx(H,{}),e.jsx(Mr,{}),e.jsx(H,{}),e.jsx(Ar,{}),e.jsx(H,{}),e.jsx(zr,{})]})})]})}function Lr(){const t=p(o=>o.venue);return e.jsxs("header",{className:"flex h-12 shrink-0 items-center justify-between gap-3 border-b border-border bg-background px-4 text-[12px]",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-[12px] font-semibold tracking-tight",children:"Venue Builder"}),e.jsxs("span",{className:"text-[12px] text-muted-foreground",children:[t.width," Ã— ",t.height]})]}),e.jsx("div",{className:"flex min-w-0 items-center justify-end overflow-x-auto",children:e.jsx(_r,{})})]})}function Wr(){const t=p(s=>s.isPreviewMode),o=p(s=>s.previewAsKiosk),r=p(s=>s.setPreviewMode),i=p(s=>s.getConfig);if(t){const s=i();return e.jsxs("div",{className:"relative h-screen w-screen",children:[e.jsx(rs,{isKiosk:o,config:s}),e.jsxs(M,{variant:"destructive",size:"sm",className:"absolute right-4 top-4 z-50 shadow-lg",onClick:()=>r(!1),children:[e.jsx(os,{className:"mr-1 h-4 w-4"})," Exit Preview"]})]})}return e.jsxs("div",{className:"flex h-screen flex-col overflow-hidden",children:[e.jsx(Lr,{}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx(Nr,{}),e.jsx(Fs,{}),e.jsx(Dr,{})]})]})}export{Wr as AdminApp};

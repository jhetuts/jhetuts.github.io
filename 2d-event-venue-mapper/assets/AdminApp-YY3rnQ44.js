import{u as p,r as x,j as e,c as ne,a as le,b as Gt,P as fe,d as oe,e as Zt,f as ht,g as Se,h as ue,i as Jt,k as Qt,L as k,I as v,B as M,l as es,s as ts,m as ss,T as He,n as G,o as Z,p as J}from"./index-jTMZzVnk.js";import{c as z,M as $e,s as nt,i as We,g as be,a as rs,B as os,u as as,b as ns,d as is,S as Ee,e as Te,f as Re,h as Pe,j as ae,D as ls,k as cs,l as ds,m as hs,n as xs,V as us,X as ps}from"./ViewerApp-4IAa-jlD.js";function fs(){const t=p(n=>n.requestFitView),o=p(n=>n.setActiveTool),r=p(n=>n.setPreviewMode),i=p(n=>n.setPreviewAsKiosk),s=p(n=>n.duplicateElements),l=p(n=>n.selectedElementIds);x.useEffect(()=>{const n=u=>{const h=u.target;if(h instanceof HTMLInputElement||h instanceof HTMLTextAreaElement||h instanceof HTMLElement&&h.isContentEditable)return;const m=u.altKey,c=u.ctrlKey||u.metaKey;if(m&&(u.key==="c"||u.key==="C")){u.preventDefault(),t();return}if(!m&&!c&&!u.shiftKey&&(u.key==="v"||u.key==="V")){u.preventDefault(),o("select");return}if(m&&(u.key==="p"||u.key==="P")){u.preventDefault(),i(!1),r(!0);return}if(m&&(u.key==="k"||u.key==="K")){u.preventDefault(),i(!0),r(!0);return}c&&(u.key==="d"||u.key==="D")&&l.length>0&&(u.preventDefault(),s(l))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[t,o,r,i,s,l])}const ms=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gs=z("circle",ms);const vs=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ie=z("copy",vs);const bs=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],js=z("download",bs);const ys=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ws=z("eye",ys);const Cs=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Ns=z("history",Cs);const ks=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],xt=z("image",ks);const Ss=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Es=z("layers",Ss);const Ts=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Rs=z("monitor",Ts);const Ps=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],Ms=z("mouse-pointer-2",Ps);const As=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],Ds=z("mouse-pointer-click",As);const _s=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],zs=z("palette",_s);const Bs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"m9 16 3-3 3 3",key:"1idcnm"}]],ut=z("panel-top-close",Bs);const Ls=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ws=z("plus",Ls);const Is=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],Hs=z("redo-2",Is);const $s=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ys=z("rotate-ccw",$s);const Xs=[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]],Os=z("spline",Xs);const Vs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],pt=z("square",Vs);const Fs=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ce=z("trash-2",Fs);const Us=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],ft=z("type",Us);const Ks=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],qs=z("undo-2",Ks);const Gs=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Zs=z("upload",Gs);function Js({gridSize:t}){return e.jsx("defs",{children:e.jsx("pattern",{id:"admin-grid-pattern",width:t,height:t,patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:`M ${t} 0 L 0 0 0 ${t}`,fill:"none",stroke:"#cbd5e1",strokeWidth:"1",opacity:"0.8"})})})}function Qs({element:t,isSelected:o,onSelect:r}){const i=t.x+t.width/2,s=t.y+t.height/2,[l,n]=x.useState(!0),u=!!t.logoUrl&&l,h=6,m=t.width-h*2,c=t.height-h*2;return e.jsxs("g",{onClick:a=>{a.stopPropagation(),r(t.id,a)},style:{cursor:"pointer"},transform:t.rotation?`rotate(${t.rotation} ${i} ${s})`:void 0,children:[t.shape==="circle"?e.jsxs(e.Fragment,{children:[e.jsx("ellipse",{cx:i,cy:s,rx:t.width/2,ry:t.height/2,fill:t.fillEnabled!==!1?t.fillColor:"transparent",stroke:t.borderColor??"#1f2937",strokeWidth:t.borderWidth??1}),o&&e.jsx("ellipse",{cx:i,cy:s,rx:t.width/2+2,ry:t.height/2+2,fill:"none",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"}),u&&e.jsx("clipPath",{id:`clip-logo-${t.id}`,children:e.jsx("ellipse",{cx:i,cy:s,rx:m/2,ry:c/2})})]}):e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,rx:Math.max(0,t.borderRadius??10),fill:t.fillEnabled!==!1?t.fillColor:"transparent",stroke:t.borderColor??"#1f2937",strokeWidth:t.borderWidth??1}),o&&e.jsx("rect",{x:t.x-2,y:t.y-2,width:t.width+4,height:t.height+4,rx:Math.max(0,(t.borderRadius??10)+2),fill:"none",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"}),u&&e.jsx("clipPath",{id:`clip-logo-${t.id}`,children:e.jsx("rect",{x:t.x+h,y:t.y+h,width:m,height:c,rx:Math.max(0,(t.borderRadius??10)-2)})})]}),u?e.jsx("image",{href:t.logoUrl,x:t.x+h,y:t.y+h,width:m,height:c,preserveAspectRatio:"xMidYMid meet",clipPath:`url(#clip-logo-${t.id})`,pointerEvents:"none",onError:()=>n(!1)}):e.jsxs(e.Fragment,{children:[e.jsx("text",{x:i,y:s-6,textAnchor:"middle",dominantBaseline:"middle",fill:t.textColor,fontSize:12,fontWeight:"600",pointerEvents:"none",children:t.name}),e.jsxs("text",{x:i,y:s+8,textAnchor:"middle",dominantBaseline:"middle",fill:t.textColor,fontSize:10,opacity:.7,pointerEvents:"none",children:["#",t.boothNumber]})]}),t.isStartingPoint&&e.jsx("foreignObject",{x:i-10,y:t.y-22,width:20,height:20,pointerEvents:"none",children:e.jsx($e,{className:"h-5 w-5 text-red-500"})})]})}function er({element:t,isSelected:o,onSelect:r}){const i=t.x+t.width/2,s=t.y+t.height/2;return e.jsxs("g",{onClick:l=>{l.stopPropagation(),r(t.id,l)},style:{cursor:"pointer"},transform:t.rotation?`rotate(${t.rotation} ${i} ${s})`:void 0,children:[o&&e.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:"transparent",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"}),e.jsx("foreignObject",{x:t.x,y:t.y,width:t.width,height:t.height,children:e.jsx("div",{style:{fontSize:t.fontSize,fontWeight:t.fontWeight,color:t.textColor,backgroundColor:t.fillColor==="transparent"?void 0:t.fillColor,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",padding:"4px"},children:t.text})})]})}function tr({element:t,isSelected:o,onSelect:r}){const i=t.x+t.width/2,s=t.y+t.height/2;return e.jsxs("g",{onClick:l=>{l.stopPropagation(),r(t.id,l)},style:{cursor:"pointer"},transform:t.rotation?`rotate(${t.rotation} ${i} ${s})`:void 0,children:[e.jsx("image",{href:t.imageUrl,x:t.x,y:t.y,width:t.width,height:t.height,opacity:t.opacity,preserveAspectRatio:"xMidYMid slice"}),o&&e.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,fill:"transparent",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"})]})}function sr({element:t,isSelected:o,onSelect:r}){const i=t.x+t.width/2,s=t.y+t.height/2;return e.jsxs("g",{onClick:l=>{l.stopPropagation(),r(t.id,l)},style:{cursor:"pointer"},transform:t.rotation?`rotate(${t.rotation} ${i} ${s})`:void 0,children:[e.jsx("rect",{x:t.x,y:t.y,width:t.width,height:t.height,rx:Math.max(0,t.borderRadius??4),fill:t.fillEnabled!==!1?t.fillColor:"transparent",stroke:t.borderColor??"#64748b",strokeWidth:t.borderWidth??2}),o&&e.jsx("rect",{x:t.x-2,y:t.y-2,width:t.width+4,height:t.height+4,rx:Math.max(0,(t.borderRadius??4)+2),fill:"none",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"6 3"})]})}function rr({element:t,isSelected:o,onSelect:r}){if(t.points.length<2)return null;const i=`arrow-${t.id}`,s=t.points.map(h=>`${h.x},${h.y}`).join(" "),l=t.connectorType==="directional",n=t.connectorType==="bidirectional",u=`arrow-start-${t.id}`;return e.jsxs("g",{onClick:h=>{h.stopPropagation(),r(t.id,h)},style:{cursor:"pointer"},children:[e.jsxs("defs",{children:[(l||n)&&e.jsx("marker",{id:i,viewBox:"0 0 10 7",refX:"10",refY:"3.5",markerWidth:"8",markerHeight:"6",orient:"auto-start-reverse",children:e.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:t.strokeColor})}),n&&e.jsx("marker",{id:u,viewBox:"0 0 10 7",refX:"0",refY:"3.5",markerWidth:"8",markerHeight:"6",orient:"auto-start-reverse",children:e.jsx("polygon",{points:"10 0, 0 3.5, 10 7",fill:t.strokeColor})})]}),o&&e.jsx("polyline",{points:s,fill:"none",stroke:"#3b82f6",strokeWidth:t.strokeWidth+4,strokeDasharray:"6 3",opacity:.4}),e.jsx("polyline",{points:s,fill:"none",stroke:t.strokeColor,strokeWidth:t.strokeWidth,strokeLinejoin:"round",strokeLinecap:"round",markerEnd:l||n?`url(#${i})`:void 0,markerStart:n?`url(#${u})`:void 0})]})}function or({element:t,isSelected:o,onSelect:r}){switch(t.type){case"booth":return e.jsx(Qs,{element:t,isSelected:o,onSelect:r});case"text":return e.jsx(er,{element:t,isSelected:o,onSelect:r});case"image":return e.jsx(tr,{element:t,isSelected:o,onSelect:r});case"barricade":return e.jsx(sr,{element:t,isSelected:o,onSelect:r});case"connector":return e.jsx(rr,{element:t,isSelected:o,onSelect:r})}}const it=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1"];function lt(){return it[Math.floor(Math.random()*it.length)]}const re=8;function ar(){const t=x.useRef(null),o=x.useRef(null),[r,i]=x.useState(null),[s,l]=x.useState(null),[n,u]=x.useState(null),[h,m]=x.useState(1),[c,a]=x.useState({x:0,y:0}),[b,R]=x.useState(null),[w,B]=x.useState(!1),[H,I]=x.useState(!1),O=x.useRef({x:0,y:0,panX:0,panY:0}),V=x.useRef(!1),ee=p(d=>d.removeElements),de=p(d=>d.moveElements);x.useEffect(()=>{const d=f=>{if(f.target instanceof HTMLInputElement||f.target instanceof HTMLTextAreaElement)return;if(f.code==="Space"&&!f.repeat){f.preventDefault(),I(!0);return}const y=p.getState(),P=y.selectedElementIds;(f.key==="Delete"||f.key==="Backspace")&&P.length>0&&(f.preventDefault(),ee(P));const S={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]}[f.key];if(S&&P.length>0){f.preventDefault();const E=f.shiftKey?y.venue.snapToGrid?y.venue.gridSize:10:1;de(P,S[0]*E,S[1]*E)}},j=f=>{f.code==="Space"&&I(!1)};return window.addEventListener("keydown",d),window.addEventListener("keyup",j),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",j)}},[ee,de]),x.useEffect(()=>{const d=o.current;if(!d)return;const j=f=>f.preventDefault();return d.addEventListener("contextmenu",j),()=>d.removeEventListener("contextmenu",j)},[]);const g=p(d=>d.venue),D=p(d=>d.elements),X=p(d=>d.selectedElementIds),T=p(d=>d.activeTool),A=p(d=>d.setSelectedElement),te=p(d=>d.toggleSelectedElement),he=p(d=>d.addElement),Ke=p(d=>d.moveElement),qe=p(d=>d.moveElements),Ge=p(d=>d.resizeElement),Ze=p(d=>d.updateElement),ye=p(d=>d.setStartingPoint),me=p(d=>d.setActiveTool),Je=p(d=>d.setVenue),_e=p(d=>d.fitViewRequest),se=X.length===1?X[0]:null,U=x.useCallback((d,j)=>{const f=t.current;if(!f)return{x:0,y:0};const y=f.getBoundingClientRect(),P=(d-y.left)/h,C=(j-y.top)/h;return{x:P,y:C}},[h]),K=x.useCallback(d=>g.snapToGrid?nt(d,g.gridSize):d,[g.snapToGrid,g.gridSize]),Qe=x.useCallback((d,j)=>D.find(f=>We(f)&&d>=f.x&&d<=f.x+f.width&&j>=f.y&&j<=f.y+f.height),[D]),Wt=x.useCallback(d=>{if(V.current){V.current=!1;return}if(r||s||n)return;const{x:j,y:f}=U(d.clientX,d.clientY),y=K(j),P=K(f);switch(T){case"booth-circle":{const C={id:be(),type:"booth",shape:"circle",x:y-40,y:P-40,width:80,height:80,rotation:0,name:"Booth",boothNumber:String(D.filter(S=>S.type==="booth").length+1),tierId:void 0,fillEnabled:!0,fillColor:lt(),borderColor:"#1f2937",borderWidth:1,borderRadius:16,textColor:"#ffffff",showWebsiteCTA:!0,showDescription:!0,isStartingPoint:!1,websiteCtaText:"Visit website",websiteCtaButtonColor:"#111827",websiteCtaTextColor:"#ffffff",websiteCtaRadius:10,showVisitedCTA:!1,visitedCtaText:"Mark as visited",visitedCtaButtonColor:"#111827",visitedCtaTextColor:"#ffffff",visitedCtaRadius:10,showFavoriteCTA:!1,favoriteCtaText:"Mark as favorite",favoriteCtaButtonColor:"#111827",favoriteCtaTextColor:"#ffffff",favoriteCtaRadius:10,showRateCTA:!1,rateCtaText:"Rate",rateCtaButtonColor:"#111827",rateCtaTextColor:"#ffffff",rateCtaRadius:10,showDirectionCTA:!0,directionCtaText:"Get direction",directionCtaButtonColor:"#111827",directionCtaTextColor:"#ffffff",directionCtaRadius:10,popupConfigured:!1};he(C),A(C.id),me("select");break}case"booth-square":{const C={id:be(),type:"booth",shape:"square",x:y-50,y:P-40,width:100,height:80,rotation:0,name:"Booth",boothNumber:String(D.filter(S=>S.type==="booth").length+1),tierId:void 0,fillEnabled:!0,fillColor:lt(),borderColor:"#1f2937",borderWidth:1,borderRadius:10,textColor:"#ffffff",showWebsiteCTA:!0,showDescription:!0,isStartingPoint:!1,websiteCtaText:"Visit website",websiteCtaButtonColor:"#111827",websiteCtaTextColor:"#ffffff",websiteCtaRadius:10,showVisitedCTA:!1,visitedCtaText:"Mark as visited",visitedCtaButtonColor:"#111827",visitedCtaTextColor:"#ffffff",visitedCtaRadius:10,showFavoriteCTA:!1,favoriteCtaText:"Mark as favorite",favoriteCtaButtonColor:"#111827",favoriteCtaTextColor:"#ffffff",favoriteCtaRadius:10,showRateCTA:!1,rateCtaText:"Rate",rateCtaButtonColor:"#111827",rateCtaTextColor:"#ffffff",rateCtaRadius:10,showDirectionCTA:!0,directionCtaText:"Get direction",directionCtaButtonColor:"#111827",directionCtaTextColor:"#ffffff",directionCtaRadius:10,popupConfigured:!1};he(C),A(C.id),me("select");break}case"text":{const C={id:be(),type:"text",x:y-60,y:P-15,width:120,height:30,rotation:0,text:"New Text",fontSize:16,fontWeight:"normal",fillColor:"transparent",textColor:"#000000"};he(C),A(C.id),me("select");break}case"barricade":{const C={id:be(),type:"barricade",x:y-60,y:P-20,width:120,height:40,rotation:0,fillEnabled:!0,fillColor:"#94a3b8",borderColor:"#64748b",borderWidth:2,borderRadius:4};he(C),A(C.id),me("select");break}case"image":{const C=window.prompt("Enter image URL:");if(C){const S={id:be(),type:"image",x:y-75,y:P-50,width:150,height:100,rotation:0,imageUrl:C,opacity:1};he(S),A(S.id)}me("select");break}case"starting-point":{const C=Qe(j,f);C&&ye(C.id);break}default:A(null);break}},[T,U,K,D,r,s,n,he,A,me,ye,Qe]),It=x.useCallback((d,j)=>{if(T==="starting-point"){const f=D.find(y=>y.id===d);f&&We(f)&&ye(d);return}j&&(j.ctrlKey||j.metaKey||j.shiftKey)?te(d):A(d)},[T,D,A,te,ye]),we=x.useCallback((d,j)=>{const f=o.current;if(!f)return null;const y=f.getBoundingClientRect(),P=y.left+c.x,C=y.top+c.y,S=P+g.width*h,E=C+g.height*h,_=Math.abs(d-P)<=re,q=Math.abs(d-S)<=re,xe=Math.abs(j-C)<=re,Le=Math.abs(j-E)<=re,ot=d>=P-re&&d<=S+re,at=j>=C-re&&j<=E+re;return _&&xe?"canvas-top-left":q&&xe?"canvas-top-right":_&&Le?"canvas-bottom-left":q&&Le?"canvas-bottom-right":_&&at?"canvas-left":q&&at?"canvas-right":xe&&ot?"canvas-top":Le&&ot?"canvas-bottom":null},[c,h,g.width,g.height]),[$,Ht]=x.useState(null),$t=x.useCallback(d=>{if(s){const j=(d.clientX-s.startX)/h,f=(d.clientY-s.startY)/h,y=_=>g.snapToGrid?nt(_,g.gridSize):_;let P=s.startWidth,C=s.startHeight,S=s.startPanX,E=s.startPanY;(s.type==="canvas-right"||s.type==="canvas-top-right"||s.type==="canvas-bottom-right")&&(P=Math.max(200,y(s.startWidth+j))),(s.type==="canvas-left"||s.type==="canvas-top-left"||s.type==="canvas-bottom-left")&&(P=Math.max(200,y(s.startWidth-j)),S=s.startPanX+(s.startWidth-P)*h),(s.type==="canvas-bottom"||s.type==="canvas-bottom-left"||s.type==="canvas-bottom-right")&&(C=Math.max(200,y(s.startHeight+f))),(s.type==="canvas-top"||s.type==="canvas-top-left"||s.type==="canvas-top-right")&&(C=Math.max(200,y(s.startHeight-f)),E=s.startPanY+(s.startHeight-C)*h),Je({width:P,height:C}),a({x:S,y:E});return}T==="select"&&!r&&!w&&Ht(we(d.clientX,d.clientY))},[s,T,r,w,h,g.snapToGrid,g.gridSize,we,Je]),Yt=x.useCallback(d=>{if(T!=="select")return;const j=we(d.clientX,d.clientY);j&&(d.preventDefault(),d.stopPropagation(),l({type:j,startX:d.clientX,startY:d.clientY,startWidth:g.width,startHeight:g.height,startPanX:c.x,startPanY:c.y}))},[T,we,g.width,g.height,c.x,c.y]),et=x.useCallback(()=>{l(null)},[]),Xt=x.useCallback(d=>{if(s)return;if(d.button===1||d.button===2||d.button===0&&d.altKey||d.button===0&&H){B(!0),O.current={x:d.clientX,y:d.clientY,panX:c.x,panY:c.y},d.preventDefault();return}const f=d.target;if(f.closest("[data-rotation-handle]")&&se){const S=U(d.clientX,d.clientY),E=D.find(_=>_.id===se);if(E&&"rotation"in E){const _=E.x+E.width/2,q=E.y+E.height/2,xe=Math.atan2(S.y-q,S.x-_);i({elementId:se,offsetX:0,offsetY:0,type:"rotate",startAngle:xe,startRotation:E.rotation})}d.stopPropagation();return}if(f.closest("[data-resize-handle]")&&se){const S=U(d.clientX,d.clientY),E=D.find(_=>_.id===se);E&&"width"in E&&i({elementId:se,offsetX:S.x-(E.x+E.width),offsetY:S.y-(E.y+E.height),type:"resize"}),d.stopPropagation();return}const C=f.closest("[data-element-id]");if(C&&T==="select"){const S=C.getAttribute("data-element-id"),E=D.find(_=>_.id===S);if(E&&"x"in E){const _=U(d.clientX,d.clientY),q=X.includes(S),xe=q&&X.length>1;!q&&!d.ctrlKey&&!d.metaKey&&!d.shiftKey&&A(S),i({elementId:S,offsetX:_.x-E.x,offsetY:_.y-E.y,type:"move",multi:xe||X.length>1&&(d.ctrlKey||d.metaKey||d.shiftKey),lastX:_.x,lastY:_.y})}return}if(T==="select"&&d.button===0&&!C){const S=U(d.clientX,d.clientY);u({startX:S.x,startY:S.y,currentX:S.x,currentY:S.y})}},[s,T,X,se,D,U,c,H,A]),Ot=x.useCallback(d=>{if(w){const f=d.clientX-O.current.x,y=d.clientY-O.current.y;a({x:O.current.panX+f,y:O.current.panY+y});return}if(n){const f=U(d.clientX,d.clientY);u(y=>y?{...y,currentX:f.x,currentY:f.y}:null);return}if(!r)return;const j=U(d.clientX,d.clientY);if(r.type==="rotate"){const f=D.find(y=>y.id===r.elementId);if(f&&"rotation"in f&&r.startAngle!=null&&r.startRotation!=null){const y=f.x+f.width/2,P=f.y+f.height/2,S=(Math.atan2(j.y-P,j.x-y)-r.startAngle)*180/Math.PI;let E=r.startRotation+S;E=(E%360+360)%360,E>180&&(E-=360),Ze(r.elementId,{rotation:Math.round(E*10)/10})}return}if(r.type==="move")if(r.multi&&X.length>1){const f=K(j.x-(r.lastX??j.x)),y=K(j.y-(r.lastY??j.y));(f!==0||y!==0)&&(qe(X,f,y),i({...r,lastX:(r.lastX??j.x)+f,lastY:(r.lastY??j.y)+y}))}else{const f=K(j.x-r.offsetX),y=K(j.y-r.offsetY);Ke(r.elementId,f,y)}else{const f=D.find(y=>y.id===r.elementId);if(f&&"width"in f){const y=Math.max(20,K(j.x-r.offsetX-f.x)),P=Math.max(20,K(j.y-r.offsetY-f.y));Ge(r.elementId,y,P)}}},[r,w,n,U,K,Ke,qe,Ge,Ze,D,X]),tt=x.useCallback(()=>{if(n){const d=Math.min(n.startX,n.currentX),j=Math.min(n.startY,n.currentY),f=Math.abs(n.currentX-n.startX),y=Math.abs(n.currentY-n.startY);if(f>3||y>3){const P=D.filter(C=>{if(!("x"in C&&"width"in C))return!1;const S=C.x,E=C.y,_=C.width,q=C.height;return S<d+f&&S+_>d&&E<j+y&&E+q>j}).map(C=>C.id);P.length>0?(p.setState({selectedElementIds:P}),V.current=!0):A(null)}u(null);return}i(null),B(!1)},[n,D,A]),ze=x.useCallback(d=>{d.preventDefault();const j=d.deltaY>0?.95:1.05;m(f=>Math.min(5,Math.max(.1,f*j)))},[]);x.useEffect(()=>{const d=o.current;if(d)return d.addEventListener("wheel",ze,{passive:!1}),()=>d.removeEventListener("wheel",ze)},[ze]);const Vt=x.useCallback(()=>m(d=>Math.min(5,d*1.25)),[]),Ft=x.useCallback(()=>m(d=>Math.max(.1,d*.8)),[]),Ut=x.useCallback(()=>{m(1),a({x:0,y:0})},[]),Be=x.useCallback(()=>{const d=t.current?.parentElement;if(!d)return;const j=d.clientWidth,f=d.clientHeight,y=Math.min(j/g.width,f/g.height)*.9;m(Math.min(5,Math.max(.1,y))),a({x:(j-g.width*y)/2,y:(f-g.height*y)/2})},[g.width,g.height]),st=x.useRef(0);x.useEffect(()=>{_e>st.current&&(st.current=_e,Be())},[_e,Be]);const Y=se?D.find(d=>d.id===se):null,Kt=Y&&"rotation"in Y,ge=Y&&We(Y)?Y:null,qt=ge&&ge.popupConfigured&&ge.id!==b?ge:null,rt=s?s.type==="canvas-left"||s.type==="canvas-right"?"ew-resize":s.type==="canvas-top"||s.type==="canvas-bottom"?"ns-resize":s.type==="canvas-top-left"||s.type==="canvas-bottom-right"?"nwse-resize":"nesw-resize":$==="canvas-left"||$==="canvas-right"?"ew-resize":$==="canvas-top"||$==="canvas-bottom"?"ns-resize":$==="canvas-top-left"||$==="canvas-bottom-right"?"nwse-resize":$==="canvas-top-right"||$==="canvas-bottom-left"?"nesw-resize":void 0;return e.jsxs("div",{ref:o,className:"relative flex-1 overflow-hidden bg-muted",onMouseMove:$t,onMouseDown:Yt,onMouseUp:et,onMouseLeave:et,style:{cursor:rt},children:[e.jsxs("svg",{ref:t,width:g.width*h,height:g.height*h,viewBox:`0 0 ${g.width} ${g.height}`,className:"absolute",style:{left:c.x,top:c.y,cursor:rt?void 0:w?"grabbing":H?"grab":n?"crosshair":r?"move":T!=="select"?"crosshair":"default"},onClick:Wt,onMouseDown:Xt,onMouseMove:Ot,onMouseUp:tt,onMouseLeave:tt,children:[e.jsx("rect",{x:"0",y:"0",width:g.width,height:g.height,fill:g.backgroundColor}),!g.backgroundImage&&e.jsx(rs,{venue:g,elements:D,idPrefix:"admin-map-bg",opacity:.55}),g.backgroundImage&&e.jsx("g",{transform:(g.backgroundRotation??0)!==0||(g.backgroundZoom??1)!==1?`translate(${g.width/2}, ${g.height/2}) rotate(${g.backgroundRotation??0}) scale(${g.backgroundZoom??1}) translate(${-g.width/2}, ${-g.height/2})`:void 0,style:{pointerEvents:"none"},children:e.jsx("image",{href:g.backgroundImage,x:"0",y:"0",width:g.width,height:g.height,opacity:g.backgroundOpacity??1,preserveAspectRatio:"xMidYMid slice"})}),g.showGrid&&e.jsxs(e.Fragment,{children:[e.jsx(Js,{gridSize:g.gridSize}),e.jsx("rect",{x:"0",y:"0",width:g.width,height:g.height,fill:"url(#admin-grid-pattern)"})]}),D.map(d=>e.jsx("g",{"data-element-id":d.id,children:e.jsx(or,{element:d,isSelected:X.includes(d.id),onSelect:It})},d.id)),Y&&"width"in Y&&e.jsx("rect",{"data-resize-handle":!0,x:Y.x+Y.width-5,y:Y.y+Y.height-5,width:10,height:10,fill:"#3b82f6",stroke:"#fff",strokeWidth:1,style:{cursor:"nwse-resize"}}),Kt&&Y&&"width"in Y&&e.jsx("ellipse",{"data-rotation-handle":!0,cx:Y.x+Y.width/2,cy:Y.y-14,rx:6,ry:6,fill:"#3b82f6",stroke:"#fff",strokeWidth:1,style:{cursor:"grab"}}),T==="select"&&e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:-3,y:g.height/2-20,width:6,height:40,rx:3,fill:"#94a3b8",opacity:$==="canvas-left"||s?.type==="canvas-left"?.9:.35,style:{cursor:"ew-resize",pointerEvents:"none"}}),e.jsx("rect",{x:g.width-3,y:g.height/2-20,width:6,height:40,rx:3,fill:"#94a3b8",opacity:$==="canvas-right"||s?.type==="canvas-right"?.9:.3,style:{cursor:"ew-resize",pointerEvents:"none"}}),e.jsx("rect",{x:g.width/2-20,y:-3,width:40,height:6,rx:3,fill:"#94a3b8",opacity:$==="canvas-top"||s?.type==="canvas-top"?.9:.35,style:{cursor:"ns-resize",pointerEvents:"none"}}),e.jsx("rect",{x:g.width/2-20,y:g.height-3,width:40,height:6,rx:3,fill:"#94a3b8",opacity:$==="canvas-bottom"||s?.type==="canvas-bottom"?.9:.3,style:{cursor:"ns-resize",pointerEvents:"none"}}),e.jsx("rect",{x:-8,y:-8,width:10,height:10,rx:2,fill:"#64748b",opacity:$==="canvas-top-left"||s?.type==="canvas-top-left"?.9:.4,style:{cursor:"nwse-resize",pointerEvents:"none"}}),e.jsx("rect",{x:g.width-8,y:-8,width:10,height:10,rx:2,fill:"#64748b",opacity:$==="canvas-top-right"||s?.type==="canvas-top-right"?.9:.4,style:{cursor:"nesw-resize",pointerEvents:"none"}}),e.jsx("rect",{x:-8,y:g.height-8,width:10,height:10,rx:2,fill:"#64748b",opacity:$==="canvas-bottom-left"||s?.type==="canvas-bottom-left"?.9:.4,style:{cursor:"nesw-resize",pointerEvents:"none"}}),e.jsx("rect",{x:g.width-8,y:g.height-8,width:10,height:10,rx:2,fill:"#64748b",opacity:$==="canvas-bottom-right"||s?.type==="canvas-bottom-right"?.9:.4,style:{cursor:"nwse-resize",pointerEvents:"none"}})]}),n&&e.jsx("rect",{x:Math.min(n.startX,n.currentX),y:Math.min(n.startY,n.currentY),width:Math.abs(n.currentX-n.startX),height:Math.abs(n.currentY-n.startY),fill:"rgba(59,130,246,0.08)",stroke:"#3b82f6",strokeWidth:1,strokeDasharray:"4 2",pointerEvents:"none"})]}),e.jsxs("div",{className:"absolute bottom-3 left-3 flex items-center gap-1 rounded-xl border bg-background/90 px-1 py-1 shadow-lg backdrop-blur-sm",children:[e.jsx("button",{className:"flex h-7 w-7 items-center justify-center rounded-lg text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:Ft,title:"Zoom out",children:"âˆ’"}),e.jsxs("button",{className:"flex h-7 min-w-14 items-center justify-center rounded-lg text-xs font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:Ut,title:"Reset zoom",children:[Math.round(h*100),"%"]}),e.jsx("button",{className:"flex h-7 w-7 items-center justify-center rounded-lg text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:Vt,title:"Zoom in",children:"+"}),e.jsx("div",{className:"mx-0.5 h-4 w-px bg-border"}),e.jsx("button",{className:"flex h-7 items-center justify-center rounded-lg px-2 text-[10px] font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",onClick:Be,title:"Fit to view (Alt+C)",children:"Fit"})]}),e.jsx(os,{booth:qt,onClose:()=>{ge&&R(ge.id)},containerRef:t,viewTransform:{x:c.x,y:c.y,scale:h}})]})}const Ye=x.forwardRef(({className:t,...o},r)=>e.jsx("textarea",{className:ne("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...o}));Ye.displayName="Textarea";var Me="Switch",[nr]=ht(Me),[ir,lr]=nr(Me),mt=x.forwardRef((t,o)=>{const{__scopeSwitch:r,name:i,checked:s,defaultChecked:l,required:n,disabled:u,value:h="on",onCheckedChange:m,form:c,...a}=t,[b,R]=x.useState(null),w=le(o,V=>R(V)),B=x.useRef(!1),H=b?c||!!b.closest("form"):!0,[I,O]=Gt({prop:s,defaultProp:l??!1,onChange:m,caller:Me});return e.jsxs(ir,{scope:r,checked:I,disabled:u,children:[e.jsx(fe.button,{type:"button",role:"switch","aria-checked":I,"aria-required":n,"data-state":jt(I),"data-disabled":u?"":void 0,disabled:u,value:h,...a,ref:w,onClick:oe(t.onClick,V=>{O(ee=>!ee),H&&(B.current=V.isPropagationStopped(),B.current||V.stopPropagation())})}),H&&e.jsx(bt,{control:b,bubbles:!B.current,name:i,value:h,checked:I,required:n,disabled:u,form:c,style:{transform:"translateX(-100%)"}})]})});mt.displayName=Me;var gt="SwitchThumb",vt=x.forwardRef((t,o)=>{const{__scopeSwitch:r,...i}=t,s=lr(gt,r);return e.jsx(fe.span,{"data-state":jt(s.checked),"data-disabled":s.disabled?"":void 0,...i,ref:o})});vt.displayName=gt;var cr="SwitchBubbleInput",bt=x.forwardRef(({__scopeSwitch:t,control:o,checked:r,bubbles:i=!0,...s},l)=>{const n=x.useRef(null),u=le(n,l),h=as(r),m=Zt(o);return x.useEffect(()=>{const c=n.current;if(!c)return;const a=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(a,"checked").set;if(h!==r&&R){const w=new Event("click",{bubbles:i});R.call(c,r),c.dispatchEvent(w)}},[h,r,i]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:u,style:{...s.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});bt.displayName=cr;function jt(t){return t?"checked":"unchecked"}var yt=mt,dr=vt;const L=x.forwardRef(({className:t,...o},r)=>e.jsx(yt,{className:ne("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...o,ref:r,children:e.jsx(dr,{className:ne("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));L.displayName=yt.displayName;function hr(t,o){return x.useReducer((r,i)=>o[r][i]??r,t)}var Xe="ScrollArea",[wt]=ht(Xe),[xr,F]=wt(Xe),Ct=x.forwardRef((t,o)=>{const{__scopeScrollArea:r,type:i="hover",dir:s,scrollHideDelay:l=600,...n}=t,[u,h]=x.useState(null),[m,c]=x.useState(null),[a,b]=x.useState(null),[R,w]=x.useState(null),[B,H]=x.useState(null),[I,O]=x.useState(0),[V,ee]=x.useState(0),[de,g]=x.useState(!1),[D,X]=x.useState(!1),T=le(o,te=>h(te)),A=ns(s);return e.jsx(xr,{scope:r,type:i,dir:A,scrollHideDelay:l,scrollArea:u,viewport:m,onViewportChange:c,content:a,onContentChange:b,scrollbarX:R,onScrollbarXChange:w,scrollbarXEnabled:de,onScrollbarXEnabledChange:g,scrollbarY:B,onScrollbarYChange:H,scrollbarYEnabled:D,onScrollbarYEnabledChange:X,onCornerWidthChange:O,onCornerHeightChange:ee,children:e.jsx(fe.div,{dir:A,...n,ref:T,style:{position:"relative","--radix-scroll-area-corner-width":I+"px","--radix-scroll-area-corner-height":V+"px",...t.style}})})});Ct.displayName=Xe;var Nt="ScrollAreaViewport",kt=x.forwardRef((t,o)=>{const{__scopeScrollArea:r,children:i,nonce:s,...l}=t,n=F(Nt,r),u=x.useRef(null),h=le(o,u,n.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),e.jsx(fe.div,{"data-radix-scroll-area-viewport":"",...l,ref:h,style:{overflowX:n.scrollbarXEnabled?"scroll":"hidden",overflowY:n.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:n.onContentChange,style:{minWidth:"100%",display:"table"},children:i})})]})});kt.displayName=Nt;var Q="ScrollAreaScrollbar",Oe=x.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=F(Q,t.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:n}=s,u=t.orientation==="horizontal";return x.useEffect(()=>(u?l(!0):n(!0),()=>{u?l(!1):n(!1)}),[u,l,n]),s.type==="hover"?e.jsx(ur,{...i,ref:o,forceMount:r}):s.type==="scroll"?e.jsx(pr,{...i,ref:o,forceMount:r}):s.type==="auto"?e.jsx(St,{...i,ref:o,forceMount:r}):s.type==="always"?e.jsx(Ve,{...i,ref:o}):null});Oe.displayName=Q;var ur=x.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=F(Q,t.__scopeScrollArea),[l,n]=x.useState(!1);return x.useEffect(()=>{const u=s.scrollArea;let h=0;if(u){const m=()=>{window.clearTimeout(h),n(!0)},c=()=>{h=window.setTimeout(()=>n(!1),s.scrollHideDelay)};return u.addEventListener("pointerenter",m),u.addEventListener("pointerleave",c),()=>{window.clearTimeout(h),u.removeEventListener("pointerenter",m),u.removeEventListener("pointerleave",c)}}},[s.scrollArea,s.scrollHideDelay]),e.jsx(Se,{present:r||l,children:e.jsx(St,{"data-state":l?"visible":"hidden",...i,ref:o})})}),pr=x.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=F(Q,t.__scopeScrollArea),l=t.orientation==="horizontal",n=De(()=>h("SCROLL_END"),100),[u,h]=hr("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(u==="idle"){const m=window.setTimeout(()=>h("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(m)}},[u,s.scrollHideDelay,h]),x.useEffect(()=>{const m=s.viewport,c=l?"scrollLeft":"scrollTop";if(m){let a=m[c];const b=()=>{const R=m[c];a!==R&&(h("SCROLL"),n()),a=R};return m.addEventListener("scroll",b),()=>m.removeEventListener("scroll",b)}},[s.viewport,l,h,n]),e.jsx(Se,{present:r||u!=="hidden",children:e.jsx(Ve,{"data-state":u==="hidden"?"hidden":"visible",...i,ref:o,onPointerEnter:oe(t.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:oe(t.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),St=x.forwardRef((t,o)=>{const r=F(Q,t.__scopeScrollArea),{forceMount:i,...s}=t,[l,n]=x.useState(!1),u=t.orientation==="horizontal",h=De(()=>{if(r.viewport){const m=r.viewport.offsetWidth<r.viewport.scrollWidth,c=r.viewport.offsetHeight<r.viewport.scrollHeight;n(u?m:c)}},10);return ve(r.viewport,h),ve(r.content,h),e.jsx(Se,{present:i||l,children:e.jsx(Ve,{"data-state":l?"visible":"hidden",...s,ref:o})})}),Ve=x.forwardRef((t,o)=>{const{orientation:r="vertical",...i}=t,s=F(Q,t.__scopeScrollArea),l=x.useRef(null),n=x.useRef(0),[u,h]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),m=Mt(u.viewport,u.content),c={...i,sizes:u,onSizesChange:h,hasThumb:m>0&&m<1,onThumbChange:b=>l.current=b,onThumbPointerUp:()=>n.current=0,onThumbPointerDown:b=>n.current=b};function a(b,R){return jr(b,n.current,u,R)}return r==="horizontal"?e.jsx(fr,{...c,ref:o,onThumbPositionChange:()=>{if(s.viewport&&l.current){const b=s.viewport.scrollLeft,R=ct(b,u,s.dir);l.current.style.transform=`translate3d(${R}px, 0, 0)`}},onWheelScroll:b=>{s.viewport&&(s.viewport.scrollLeft=b)},onDragScroll:b=>{s.viewport&&(s.viewport.scrollLeft=a(b,s.dir))}}):r==="vertical"?e.jsx(mr,{...c,ref:o,onThumbPositionChange:()=>{if(s.viewport&&l.current){const b=s.viewport.scrollTop,R=ct(b,u);l.current.style.transform=`translate3d(0, ${R}px, 0)`}},onWheelScroll:b=>{s.viewport&&(s.viewport.scrollTop=b)},onDragScroll:b=>{s.viewport&&(s.viewport.scrollTop=a(b))}}):null}),fr=x.forwardRef((t,o)=>{const{sizes:r,onSizesChange:i,...s}=t,l=F(Q,t.__scopeScrollArea),[n,u]=x.useState(),h=x.useRef(null),m=le(o,h,l.onScrollbarXChange);return x.useEffect(()=>{h.current&&u(getComputedStyle(h.current))},[h]),e.jsx(Tt,{"data-orientation":"horizontal",...s,ref:m,sizes:r,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Ae(r)+"px",...t.style},onThumbPointerDown:c=>t.onThumbPointerDown(c.x),onDragScroll:c=>t.onDragScroll(c.x),onWheelScroll:(c,a)=>{if(l.viewport){const b=l.viewport.scrollLeft+c.deltaX;t.onWheelScroll(b),Dt(b,a)&&c.preventDefault()}},onResize:()=>{h.current&&l.viewport&&n&&i({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:h.current.clientWidth,paddingStart:ke(n.paddingLeft),paddingEnd:ke(n.paddingRight)}})}})}),mr=x.forwardRef((t,o)=>{const{sizes:r,onSizesChange:i,...s}=t,l=F(Q,t.__scopeScrollArea),[n,u]=x.useState(),h=x.useRef(null),m=le(o,h,l.onScrollbarYChange);return x.useEffect(()=>{h.current&&u(getComputedStyle(h.current))},[h]),e.jsx(Tt,{"data-orientation":"vertical",...s,ref:m,sizes:r,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Ae(r)+"px",...t.style},onThumbPointerDown:c=>t.onThumbPointerDown(c.y),onDragScroll:c=>t.onDragScroll(c.y),onWheelScroll:(c,a)=>{if(l.viewport){const b=l.viewport.scrollTop+c.deltaY;t.onWheelScroll(b),Dt(b,a)&&c.preventDefault()}},onResize:()=>{h.current&&l.viewport&&n&&i({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:h.current.clientHeight,paddingStart:ke(n.paddingTop),paddingEnd:ke(n.paddingBottom)}})}})}),[gr,Et]=wt(Q),Tt=x.forwardRef((t,o)=>{const{__scopeScrollArea:r,sizes:i,hasThumb:s,onThumbChange:l,onThumbPointerUp:n,onThumbPointerDown:u,onThumbPositionChange:h,onDragScroll:m,onWheelScroll:c,onResize:a,...b}=t,R=F(Q,r),[w,B]=x.useState(null),H=le(o,T=>B(T)),I=x.useRef(null),O=x.useRef(""),V=R.viewport,ee=i.content-i.viewport,de=ue(c),g=ue(h),D=De(a,10);function X(T){if(I.current){const A=T.clientX-I.current.left,te=T.clientY-I.current.top;m({x:A,y:te})}}return x.useEffect(()=>{const T=A=>{const te=A.target;w?.contains(te)&&de(A,ee)};return document.addEventListener("wheel",T,{passive:!1}),()=>document.removeEventListener("wheel",T,{passive:!1})},[V,w,ee,de]),x.useEffect(g,[i,g]),ve(w,D),ve(R.content,D),e.jsx(gr,{scope:r,scrollbar:w,hasThumb:s,onThumbChange:ue(l),onThumbPointerUp:ue(n),onThumbPositionChange:g,onThumbPointerDown:ue(u),children:e.jsx(fe.div,{...b,ref:H,style:{position:"absolute",...b.style},onPointerDown:oe(t.onPointerDown,T=>{T.button===0&&(T.target.setPointerCapture(T.pointerId),I.current=w.getBoundingClientRect(),O.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",R.viewport&&(R.viewport.style.scrollBehavior="auto"),X(T))}),onPointerMove:oe(t.onPointerMove,X),onPointerUp:oe(t.onPointerUp,T=>{const A=T.target;A.hasPointerCapture(T.pointerId)&&A.releasePointerCapture(T.pointerId),document.body.style.webkitUserSelect=O.current,R.viewport&&(R.viewport.style.scrollBehavior=""),I.current=null})})})}),Ne="ScrollAreaThumb",Rt=x.forwardRef((t,o)=>{const{forceMount:r,...i}=t,s=Et(Ne,t.__scopeScrollArea);return e.jsx(Se,{present:r||s.hasThumb,children:e.jsx(vr,{ref:o,...i})})}),vr=x.forwardRef((t,o)=>{const{__scopeScrollArea:r,style:i,...s}=t,l=F(Ne,r),n=Et(Ne,r),{onThumbPositionChange:u}=n,h=le(o,a=>n.onThumbChange(a)),m=x.useRef(void 0),c=De(()=>{m.current&&(m.current(),m.current=void 0)},100);return x.useEffect(()=>{const a=l.viewport;if(a){const b=()=>{if(c(),!m.current){const R=yr(a,u);m.current=R,u()}};return u(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[l.viewport,c,u]),e.jsx(fe.div,{"data-state":n.hasThumb?"visible":"hidden",...s,ref:h,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:oe(t.onPointerDownCapture,a=>{const R=a.target.getBoundingClientRect(),w=a.clientX-R.left,B=a.clientY-R.top;n.onThumbPointerDown({x:w,y:B})}),onPointerUp:oe(t.onPointerUp,n.onThumbPointerUp)})});Rt.displayName=Ne;var Fe="ScrollAreaCorner",Pt=x.forwardRef((t,o)=>{const r=F(Fe,t.__scopeScrollArea),i=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&i?e.jsx(br,{...t,ref:o}):null});Pt.displayName=Fe;var br=x.forwardRef((t,o)=>{const{__scopeScrollArea:r,...i}=t,s=F(Fe,r),[l,n]=x.useState(0),[u,h]=x.useState(0),m=!!(l&&u);return ve(s.scrollbarX,()=>{const c=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(c),h(c)}),ve(s.scrollbarY,()=>{const c=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(c),n(c)}),m?e.jsx(fe.div,{...i,ref:o,style:{width:l,height:u,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function ke(t){return t?parseInt(t,10):0}function Mt(t,o){const r=t/o;return isNaN(r)?0:r}function Ae(t){const o=Mt(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=(t.scrollbar.size-r)*o;return Math.max(i,18)}function jr(t,o,r,i="ltr"){const s=Ae(r),l=s/2,n=o||l,u=s-n,h=r.scrollbar.paddingStart+n,m=r.scrollbar.size-r.scrollbar.paddingEnd-u,c=r.content-r.viewport,a=i==="ltr"?[0,c]:[c*-1,0];return At([h,m],a)(t)}function ct(t,o,r="ltr"){const i=Ae(o),s=o.scrollbar.paddingStart+o.scrollbar.paddingEnd,l=o.scrollbar.size-s,n=o.content-o.viewport,u=l-i,h=r==="ltr"?[0,n]:[n*-1,0],m=is(t,h);return At([0,n],[0,u])(m)}function At(t,o){return r=>{if(t[0]===t[1]||o[0]===o[1])return o[0];const i=(o[1]-o[0])/(t[1]-t[0]);return o[0]+i*(r-t[0])}}function Dt(t,o){return t>0&&t<o}var yr=(t,o=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},i=0;return(function s(){const l={left:t.scrollLeft,top:t.scrollTop},n=r.left!==l.left,u=r.top!==l.top;(n||u)&&o(),r=l,i=window.requestAnimationFrame(s)})(),()=>window.cancelAnimationFrame(i)};function De(t,o){const r=ue(t),i=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(i.current),[]),x.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(r,o)},[r,o])}function ve(t,o){const r=ue(o);Jt(()=>{let i=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(r)});return s.observe(t),()=>{window.cancelAnimationFrame(i),s.unobserve(t)}}},[t,r])}var _t=Ct,wr=kt,Cr=Pt;const Ue=x.forwardRef(({className:t,children:o,...r},i)=>e.jsxs(_t,{ref:i,className:ne("relative overflow-hidden",t),...r,children:[e.jsx(wr,{className:"h-full w-full rounded-[inherit]",children:o}),e.jsx(zt,{}),e.jsx(Cr,{})]}));Ue.displayName=_t.displayName;const zt=x.forwardRef(({className:t,orientation:o="vertical",...r},i)=>e.jsx(Oe,{ref:i,orientation:o,className:ne("flex touch-none select-none transition-colors",o==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",o==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:e.jsx(Rt,{className:"relative flex-1 rounded-full bg-border"})}));zt.displayName=Oe.displayName;var Nr=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],kr=Nr.reduce((t,o)=>{const r=Qt(`Primitive.${o}`),i=x.forwardRef((s,l)=>{const{asChild:n,...u}=s,h=n?r:o;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(h,{...u,ref:l})});return i.displayName=`Primitive.${o}`,{...t,[o]:i}},{}),Sr="Separator",dt="horizontal",Er=["horizontal","vertical"],Bt=x.forwardRef((t,o)=>{const{decorative:r,orientation:i=dt,...s}=t,l=Tr(i)?i:dt,u=r?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return e.jsx(kr.div,{"data-orientation":l,...u,...s,ref:o})});Bt.displayName=Sr;function Tr(t){return Er.includes(t)}var Lt=Bt;const W=x.forwardRef(({className:t,orientation:o="horizontal",decorative:r=!0,...i},s)=>e.jsx(Lt,{ref:s,decorative:r,orientation:o,className:ne("shrink-0 bg-border",o==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...i}));W.displayName=Lt.displayName;const Ie="__no_tier__";function pe({children:t}){return e.jsx("h3",{className:"mb-2 text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:t})}function N({label:t,children:o}){return e.jsxs("div",{className:"grid grid-cols-[1fr_1fr] items-center gap-2",children:[e.jsx(k,{className:"text-xs",children:t}),o]})}function Rr({element:t}){const[o,r]=x.useState(!0),[i,s]=x.useState(!1),l=p(a=>a.updateElement),n=p(a=>a.removeElement),u=p(a=>a.setStartingPoint),h=p(a=>a.duplicateElements),m=p(a=>a.venue.tiers);x.useEffect(()=>{queueMicrotask(()=>{r(!0),s(!1)})},[t.id]);const c=a=>l(t.id,{...a,popupConfigured:!0});return e.jsxs("div",{className:"space-y-2.5",children:[e.jsx(N,{label:"Name",children:e.jsx(v,{value:t.name,onChange:a=>l(t.id,{name:a.target.value}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Booth #",children:e.jsx(v,{value:t.boothNumber,onChange:a=>l(t.id,{boothNumber:a.target.value}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Tier",children:e.jsxs(Ee,{value:t.tierId??Ie,onValueChange:a=>l(t.id,{tierId:a===Ie?void 0:a}),children:[e.jsx(Te,{className:"h-8 text-xs",children:e.jsx(Re,{placeholder:"No tier"})}),e.jsxs(Pe,{children:[e.jsx(ae,{value:Ie,className:"text-xs text-muted-foreground",children:"No tier"}),m.map(a=>e.jsx(ae,{value:a.id,className:"text-xs",children:a.name},a.id))]})]})}),e.jsxs("div",{className:"rounded-md border border-border/70 p-2.5 space-y-2",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between",onClick:()=>{s(a=>!a),c({})},children:[e.jsx(k,{className:"cursor-pointer text-xs font-medium",children:"Popup Appearance"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:i?"Hide":"Show"})]}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-md border border-border/60 p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-xs",children:"Show Description"}),e.jsx(L,{checked:t.showDescription,onCheckedChange:a=>c({showDescription:a})})]}),t.showDescription&&e.jsx(Ye,{value:t.description??"",onChange:a=>c({description:a.target.value}),className:"min-h-[60px] text-xs",rows:3})]}),e.jsxs("div",{className:"rounded-md border border-border/60 p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-xs",children:"Visit Website"}),e.jsx(L,{checked:t.showWebsiteCTA,onCheckedChange:a=>c({showWebsiteCTA:a})})]}),t.showWebsiteCTA&&e.jsxs(e.Fragment,{children:[e.jsx(v,{value:t.websiteUrl??"",onChange:a=>c({websiteUrl:a.target.value}),placeholder:"https://...",className:"h-8 text-xs"}),e.jsx(N,{label:"Text",children:e.jsx(v,{value:t.websiteCtaText??"Visit website",onChange:a=>c({websiteCtaText:a.target.value}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Color",children:e.jsx(v,{type:"color",value:t.websiteCtaButtonColor??"#111827",onChange:a=>c({websiteCtaButtonColor:a.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Text Color",children:e.jsx(v,{type:"color",value:t.websiteCtaTextColor??"#ffffff",onChange:a=>c({websiteCtaTextColor:a.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Radius",children:e.jsx(v,{type:"number",min:0,max:24,value:t.websiteCtaRadius??10,onChange:a=>c({websiteCtaRadius:Number(a.target.value)}),className:"h-8 text-xs"})})]})]}),[{title:"Mark as Visited",show:t.showVisitedCTA,setShow:a=>c({showVisitedCTA:a}),text:t.visitedCtaText??"Mark as visited",setText:a=>c({visitedCtaText:a}),color:t.visitedCtaButtonColor??"#111827",setColor:a=>c({visitedCtaButtonColor:a}),textColor:t.visitedCtaTextColor??"#ffffff",setTextColor:a=>c({visitedCtaTextColor:a}),radius:t.visitedCtaRadius??10,setRadius:a=>c({visitedCtaRadius:a})},{title:"Mark as Favorite",show:t.showFavoriteCTA,setShow:a=>c({showFavoriteCTA:a}),text:t.favoriteCtaText??"Mark as favorite",setText:a=>c({favoriteCtaText:a}),color:t.favoriteCtaButtonColor??"#111827",setColor:a=>c({favoriteCtaButtonColor:a}),textColor:t.favoriteCtaTextColor??"#ffffff",setTextColor:a=>c({favoriteCtaTextColor:a}),radius:t.favoriteCtaRadius??10,setRadius:a=>c({favoriteCtaRadius:a})},{title:"Rate (5 star)",show:t.showRateCTA,setShow:a=>c({showRateCTA:a}),text:t.rateCtaText??"Rate",setText:a=>c({rateCtaText:a}),color:t.rateCtaButtonColor??"#111827",setColor:a=>c({rateCtaButtonColor:a}),textColor:t.rateCtaTextColor??"#ffffff",setTextColor:a=>c({rateCtaTextColor:a}),radius:t.rateCtaRadius??10,setRadius:a=>c({rateCtaRadius:a})},{title:"Get Direction",show:t.showDirectionCTA,setShow:a=>c({showDirectionCTA:a}),text:t.directionCtaText??"Get direction",setText:a=>c({directionCtaText:a}),color:t.directionCtaButtonColor??"#111827",setColor:a=>c({directionCtaButtonColor:a}),textColor:t.directionCtaTextColor??"#ffffff",setTextColor:a=>c({directionCtaTextColor:a}),radius:t.directionCtaRadius??10,setRadius:a=>c({directionCtaRadius:a})}].map(a=>e.jsxs("div",{className:"rounded-md border border-border/60 p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-xs",children:a.title}),e.jsx(L,{checked:a.show,onCheckedChange:a.setShow})]}),a.show&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:"Text",children:e.jsx(v,{value:a.text,onChange:b=>a.setText(b.target.value),className:"h-8 text-xs"})}),e.jsx(N,{label:"Color",children:e.jsx(v,{type:"color",value:a.color,onChange:b=>a.setColor(b.target.value),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Text Color",children:e.jsx(v,{type:"color",value:a.textColor,onChange:b=>a.setTextColor(b.target.value),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Radius",children:e.jsx(v,{type:"number",min:0,max:24,value:a.radius,onChange:b=>a.setRadius(Number(b.target.value)),className:"h-8 text-xs"})})]})]},a.title))]})]}),e.jsxs("div",{className:"rounded-md border border-border/70 p-2.5 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-xs font-medium",children:"Booth Appearance"}),e.jsx(L,{checked:o,onCheckedChange:r})]}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Logo URL"}),e.jsx(v,{value:t.logoUrl??"",onChange:a=>l(t.id,{logoUrl:a.target.value||void 0}),placeholder:"https://example.com/logo.png",className:"h-8 text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border/60 px-2",children:[e.jsx(k,{className:"text-xs",children:"Fill"}),e.jsx(L,{checked:t.fillEnabled!==!1,onCheckedChange:a=>l(t.id,{fillEnabled:a})})]}),e.jsx(v,{type:"color",value:t.fillColor??"#3b82f6",disabled:t.fillEnabled===!1,onChange:a=>l(t.id,{fillColor:a.target.value}),className:"h-8 cursor-pointer p-1 disabled:cursor-not-allowed"})]}),e.jsx(N,{label:"Border Color",children:e.jsx(v,{type:"color",value:t.borderColor??"#1f2937",onChange:a=>l(t.id,{borderColor:a.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Border Width",children:e.jsx(v,{type:"number",min:0,max:12,value:t.borderWidth??1,onChange:a=>l(t.id,{borderWidth:Number(a.target.value)}),className:"h-8 text-xs"})}),t.shape==="square"&&e.jsx(N,{label:"Radius",children:e.jsx(v,{type:"number",min:0,max:Math.min(t.width,t.height)/2,value:t.borderRadius??10,onChange:a=>l(t.id,{borderRadius:Number(a.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Text Color",children:e.jsx(v,{type:"color",value:t.textColor,onChange:a=>l(t.id,{textColor:a.target.value}),className:"h-8 cursor-pointer p-1"})})]})]}),e.jsx(W,{}),e.jsx(pe,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Width"}),e.jsx(v,{type:"number",value:t.width,onChange:a=>l(t.id,{width:Number(a.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Height"}),e.jsx(v,{type:"number",value:t.height,onChange:a=>l(t.id,{height:Number(a.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Rotation"}),e.jsx(v,{type:"number",value:t.rotation,onChange:a=>l(t.id,{rotation:Number(a.target.value)}),className:"h-8 text-xs"})]})]}),e.jsx(N,{label:"X Position",children:e.jsx(v,{type:"number",value:Math.round(t.x),onChange:a=>l(t.id,{x:Number(a.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Y Position",children:e.jsx(v,{type:"number",value:Math.round(t.y),onChange:a=>l(t.id,{y:Number(a.target.value)}),className:"h-8 text-xs"})}),e.jsx(W,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>u(t.id),children:[e.jsx($e,{className:"mr-1 h-3 w-3"})," Set Start"]}),e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>h([t.id]),children:[e.jsx(ie,{className:"mr-1 h-3 w-3"})," Duplicate"]})]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"w-full text-xs",onClick:()=>n(t.id),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Delete"]})]})}function Pr({element:t}){const o=p(s=>s.updateElement),r=p(s=>s.removeElement),i=p(s=>s.duplicateElements);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Text Content"}),e.jsx(Ye,{value:t.text,onChange:s=>o(t.id,{text:s.target.value}),className:"mt-1 min-h-[60px] text-xs",rows:3})]}),e.jsx(N,{label:"Font Size",children:e.jsx(v,{type:"number",value:t.fontSize,min:8,onChange:s=>o(t.id,{fontSize:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Font Weight",children:e.jsxs(Ee,{value:t.fontWeight,onValueChange:s=>o(t.id,{fontWeight:s}),children:[e.jsx(Te,{className:"h-8 text-xs",children:e.jsx(Re,{})}),e.jsxs(Pe,{children:[e.jsx(ae,{value:"normal",children:"Normal"}),e.jsx(ae,{value:"bold",children:"Bold"})]})]})}),e.jsx(N,{label:"Fill Color",children:e.jsx(v,{type:"color",value:t.fillColor==="transparent"?"#ffffff":t.fillColor,onChange:s=>o(t.id,{fillColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Text Color",children:e.jsx(v,{type:"color",value:t.textColor,onChange:s=>o(t.id,{textColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(W,{}),e.jsx(pe,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Width"}),e.jsx(v,{type:"number",value:t.width,onChange:s=>o(t.id,{width:Number(s.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Height"}),e.jsx(v,{type:"number",value:t.height,onChange:s=>o(t.id,{height:Number(s.target.value)}),className:"h-8 text-xs"})]})]}),e.jsx(N,{label:"Rotation",children:e.jsx(v,{type:"number",value:t.rotation,onChange:s=>o(t.id,{rotation:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(W,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i([t.id]),children:[e.jsx(ie,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(t.id),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})}function Mr({element:t}){const o=p(s=>s.updateElement),r=p(s=>s.removeElement),i=p(s=>s.duplicateElements);return e.jsxs("div",{className:"space-y-3",children:[e.jsx(pe,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Width"}),e.jsx(v,{type:"number",value:t.width,onChange:s=>o(t.id,{width:Number(s.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Height"}),e.jsx(v,{type:"number",value:t.height,onChange:s=>o(t.id,{height:Number(s.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Rotation"}),e.jsx(v,{type:"number",value:t.rotation,onChange:s=>o(t.id,{rotation:Number(s.target.value)}),className:"h-8 text-xs"})]})]}),e.jsx(N,{label:"X Position",children:e.jsx(v,{type:"number",value:Math.round(t.x),onChange:s=>o(t.id,{x:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Y Position",children:e.jsx(v,{type:"number",value:Math.round(t.y),onChange:s=>o(t.id,{y:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(W,{}),e.jsx(pe,{children:"Barricade appearance"}),e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-2",children:[e.jsx(k,{className:"text-xs",children:"Fill"}),e.jsx(L,{checked:t.fillEnabled!==!1,onCheckedChange:s=>o(t.id,{fillEnabled:s})})]}),e.jsx(N,{label:"Fill Color",children:e.jsx(v,{type:"color",value:t.fillColor,onChange:s=>o(t.id,{fillColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Border Color",children:e.jsx(v,{type:"color",value:t.borderColor,onChange:s=>o(t.id,{borderColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Border Width",children:e.jsx(v,{type:"number",value:t.borderWidth,min:0,onChange:s=>o(t.id,{borderWidth:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Border Radius",children:e.jsx(v,{type:"number",value:t.borderRadius,min:0,onChange:s=>o(t.id,{borderRadius:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(W,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i([t.id]),children:[e.jsx(ie,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(t.id),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})}function Ar({element:t}){const o=p(s=>s.updateElement),r=p(s=>s.removeElement),i=p(s=>s.duplicateElements);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Image URL"}),e.jsx(v,{value:t.imageUrl,onChange:s=>o(t.id,{imageUrl:s.target.value}),placeholder:"https://...",className:"h-8 text-xs"})]}),e.jsx(N,{label:"Opacity",children:e.jsx("input",{type:"range",min:0,max:1,step:.05,value:t.opacity,onChange:s=>o(t.id,{opacity:Number(s.target.value)}),className:"w-full"})}),e.jsx(W,{}),e.jsx(pe,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Width"}),e.jsx(v,{type:"number",value:t.width,onChange:s=>o(t.id,{width:Number(s.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Height"}),e.jsx(v,{type:"number",value:t.height,onChange:s=>o(t.id,{height:Number(s.target.value)}),className:"h-8 text-xs"})]})]}),e.jsx(N,{label:"Rotation",children:e.jsx(v,{type:"number",value:t.rotation,onChange:s=>o(t.id,{rotation:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(W,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i([t.id]),children:[e.jsx(ie,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(t.id),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})}function Dr({element:t}){const o=p(s=>s.updateElement),r=p(s=>s.removeElement),i=p(s=>s.duplicateElements);return e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{label:"Type",children:e.jsxs(Ee,{value:t.connectorType,onValueChange:s=>o(t.id,{connectorType:s}),children:[e.jsx(Te,{className:"h-8 text-xs",children:e.jsx(Re,{})}),e.jsxs(Pe,{children:[e.jsx(ae,{value:"directional",children:"Directional"}),e.jsx(ae,{value:"bidirectional",children:"Bidirectional"}),e.jsx(ae,{value:"polyline",children:"Polyline"})]})]})}),e.jsx(N,{label:"Stroke Color",children:e.jsx(v,{type:"color",value:t.strokeColor,onChange:s=>o(t.id,{strokeColor:s.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Stroke Width",children:e.jsx(v,{type:"number",value:t.strokeWidth,min:1,max:20,onChange:s=>o(t.id,{strokeWidth:Number(s.target.value)}),className:"h-8 text-xs"})}),e.jsx(W,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i([t.id]),children:[e.jsx(ie,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(t.id),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})}function _r({ids:t,booths:o}){const r=p(n=>n.updateElements),i=o[0];if(!i)return null;const s=o.every(n=>n.shape==="square"),l=n=>r(t,n);return e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsx(pe,{children:"Booth & Popup (common)"}),e.jsxs("div",{className:"space-y-3 rounded-md border border-border/70 p-2.5",children:[e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["Apply to all ",o.length," booths. Booth and popup options shared across selection."]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Booth appearance"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border/60 px-2",children:[e.jsx(k,{className:"text-xs",children:"Fill"}),e.jsx(L,{checked:i.fillEnabled!==!1,onCheckedChange:n=>l({fillEnabled:n})})]}),e.jsx(v,{type:"color",value:i.fillColor??"#3b82f6",disabled:i.fillEnabled===!1,onChange:n=>l({fillColor:n.target.value}),className:"h-8 cursor-pointer p-1 disabled:cursor-not-allowed"})]}),e.jsx(N,{label:"Border Color",children:e.jsx(v,{type:"color",value:i.borderColor??"#1f2937",onChange:n=>l({borderColor:n.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(N,{label:"Border Width",children:e.jsx(v,{type:"number",min:0,max:12,value:i.borderWidth??1,onChange:n=>l({borderWidth:Number(n.target.value)}),className:"h-8 text-xs"})}),s&&e.jsx(N,{label:"Corner Radius",children:e.jsx(v,{type:"number",min:0,value:i.borderRadius??10,onChange:n=>l({borderRadius:Number(n.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Text Color",children:e.jsx(v,{type:"color",value:i.textColor,onChange:n=>l({textColor:n.target.value}),className:"h-8 cursor-pointer p-1"})})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-border/60",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Popup appearance"}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"text-xs",children:"Description"}),e.jsx(L,{checked:i.showDescription,onCheckedChange:n=>l({showDescription:n,popupConfigured:!0})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"text-xs",children:"Visit website"}),e.jsx(L,{checked:i.showWebsiteCTA,onCheckedChange:n=>l({showWebsiteCTA:n,popupConfigured:!0})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"text-xs",children:"Mark visited"}),e.jsx(L,{checked:i.showVisitedCTA,onCheckedChange:n=>l({showVisitedCTA:n,popupConfigured:!0})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"text-xs",children:"Favorite"}),e.jsx(L,{checked:i.showFavoriteCTA,onCheckedChange:n=>l({showFavoriteCTA:n,popupConfigured:!0})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"text-xs",children:"Rate"}),e.jsx(L,{checked:i.showRateCTA,onCheckedChange:n=>l({showRateCTA:n,popupConfigured:!0})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"text-xs",children:"Get direction"}),e.jsx(L,{checked:i.showDirectionCTA,onCheckedChange:n=>l({showDirectionCTA:n,popupConfigured:!0})})]})]})]})]})]})}function zr({elements:t}){const o=p(a=>a.updateElements),r=p(a=>a.removeElements),i=p(a=>a.duplicateElements),s=t.map(a=>a.id),l=t.every(a=>"width"in a&&"height"in a),n=t.every(a=>"x"in a&&"y"in a),u=t.every(a=>"rotation"in a),h=t.every(a=>"fillColor"in a),m=t.every(a=>"textColor"in a),c=t.length>0&&t.every(a=>a.type==="booth");return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-md bg-muted/50 p-2",children:[e.jsxs("p",{className:"text-xs font-medium",children:[t.length," elements selected"]}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Editing shared properties will apply to all selected elements."})]}),c&&e.jsx(_r,{ids:s,booths:t}),l&&e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsx(pe,{children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Width"}),e.jsx(v,{type:"number",placeholder:"mixed",onChange:a=>{const b=Number(a.target.value);b>0&&o(s,{width:b})},className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Height"}),e.jsx(v,{type:"number",placeholder:"mixed",onChange:a=>{const b=Number(a.target.value);b>0&&o(s,{height:b})},className:"h-8 text-xs"})]})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:"X Position",children:e.jsx(v,{type:"number",placeholder:"mixed",onChange:a=>o(s,{x:Number(a.target.value)}),className:"h-8 text-xs"})}),e.jsx(N,{label:"Y Position",children:e.jsx(v,{type:"number",placeholder:"mixed",onChange:a=>o(s,{y:Number(a.target.value)}),className:"h-8 text-xs"})})]}),u&&e.jsx(N,{label:"Rotation",children:e.jsx(v,{type:"number",placeholder:"mixed",onChange:a=>o(s,{rotation:Number(a.target.value)}),className:"h-8 text-xs"})}),h&&e.jsx(N,{label:"Fill Color",children:e.jsx(v,{type:"color",onChange:a=>o(s,{fillColor:a.target.value}),className:"h-8 cursor-pointer p-1"})}),m&&e.jsx(N,{label:"Text Color",children:e.jsx(v,{type:"color",onChange:a=>o(s,{textColor:a.target.value}),className:"h-8 cursor-pointer p-1"})}),e.jsx(W,{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",size:"sm",className:"flex-1 text-xs",onClick:()=>i(s),children:[e.jsx(ie,{className:"mr-1 h-3 w-3"})," Duplicate"]}),e.jsxs(M,{variant:"destructive",size:"sm",className:"flex-1 text-xs",onClick:()=>r(s),children:[e.jsx(ce,{className:"mr-1 h-3 w-3"})," Delete All"]})]})]})}function Br({element:t,elements:o}){const r=p(i=>i.setSelectedElement);return e.jsxs("div",{className:"mb-3",children:[e.jsx(k,{className:"text-xs",children:"Selected Element"}),e.jsxs(Ee,{value:t.id,onValueChange:i=>r(i),children:[e.jsx(Te,{className:"mt-1 h-8 text-xs",children:e.jsx(Re,{})}),e.jsx(Pe,{children:o.map(i=>e.jsx(ae,{value:i.id,className:"text-xs",children:i.type==="booth"?`${i.name} (#${i.boothNumber})`:i.type==="text"?i.text.slice(0,25):i.type==="image"?"Image":i.type==="barricade"?"Barricade":`Connector (${i.connectorType})`},i.id))})]})]})}function Lr(){return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 py-12 text-center",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-muted",children:e.jsx(Ds,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"No element selected"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Click an element on the canvas or select from the elements list."})]})]})}function Wr(){const t=p(n=>n.selectedElementIds),o=p(n=>n.elements),r=t.map(n=>o.find(u=>u.id===n)).filter(Boolean),i=r.length>1,s=r.length===1?r[0]:null,l=i?`${r.length} Elements`:s?`${s.type.charAt(0).toUpperCase()+s.type.slice(1)} Properties`:"Properties";return e.jsxs("aside",{className:"flex w-72 flex-col border-r border-border bg-background [&_button]:text-[12px] [&_h2]:text-[12px] [&_h3]:text-[12px] [&_input]:text-[12px] [&_label]:text-[12px] [&_p]:text-[12px] [&_span]:text-[12px] [&_textarea]:text-[12px]",children:[e.jsx("div",{className:"flex h-10 shrink-0 items-center border-b border-border px-4",children:e.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:l})}),e.jsx(Ue,{className:"flex-1",children:e.jsxs("div",{className:"p-4",children:[i&&e.jsx(zr,{elements:r}),s&&e.jsxs(e.Fragment,{children:[e.jsx(Br,{element:s,elements:o}),s.type==="booth"&&e.jsx(Rr,{element:s}),s.type==="text"&&e.jsx(Pr,{element:s}),s.type==="image"&&e.jsx(Ar,{element:s}),s.type==="barricade"&&e.jsx(Mr,{element:s}),s.type==="connector"&&e.jsx(Dr,{element:s})]}),r.length===0&&e.jsx(Lr,{})]})})]})}const Ir=[{tool:"select",icon:e.jsx(Ms,{className:"h-4 w-4"}),label:"Select"},{tool:"text",icon:e.jsx(ft,{className:"h-4 w-4"}),label:"Text"},{tool:"booth-circle",icon:e.jsx(gs,{className:"h-4 w-4"}),label:"Circle Booth"},{tool:"booth-square",icon:e.jsx(pt,{className:"h-4 w-4"}),label:"Square Booth"},{tool:"image",icon:e.jsx(xt,{className:"h-4 w-4"}),label:"Image"},{tool:"barricade",icon:e.jsx(ut,{className:"h-4 w-4"}),label:"Barricade"}];function je({children:t}){return e.jsx("h3",{className:"mb-2 text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:t})}function Ce({label:t,children:o}){return e.jsxs("div",{className:"grid grid-cols-[1fr_1fr] items-center gap-2",children:[e.jsx(k,{className:"text-xs",children:t}),o]})}function Hr(){const t=p(r=>r.activeTool),o=p(r=>r.setActiveTool);return e.jsxs("div",{children:[e.jsx(je,{children:"Tools"}),e.jsx(He,{delayDuration:200,children:e.jsx("div",{className:"grid grid-cols-6 gap-2",children:Ir.map(({tool:r,icon:i,label:s})=>e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:t===r?"default":"outline",size:"icon",className:ne("h-9 w-9 cursor-pointer",t===r&&"ring-2 ring-primary/30"),onClick:()=>o(r),children:i})}),e.jsxs(J,{side:"bottom",children:[s,r==="select"&&e.jsx("span",{className:"ml-1 text-muted-foreground",children:"(V)"})]})]},r))})})]})}const $r={booth:e.jsx(pt,{className:"h-3.5 w-3.5 text-blue-500"}),text:e.jsx(ft,{className:"h-3.5 w-3.5 text-amber-500"}),image:e.jsx(xt,{className:"h-3.5 w-3.5 text-emerald-500"}),barricade:e.jsx(ut,{className:"h-3.5 w-3.5 text-slate-500"}),connector:e.jsx(Os,{className:"h-3.5 w-3.5 text-purple-500"})};function Yr(t){switch(t.type){case"booth":return`${t.name} (#${t.boothNumber})`;case"text":return t.text.length>20?t.text.slice(0,20)+"â€¦":t.text;case"image":return"Image";case"barricade":return"Barricade";case"connector":return`Connector (${t.connectorType})`}}function Xr(){const t=p(h=>h.elements),o=p(h=>h.selectedElementIds),r=p(h=>h.setSelectedElement),i=p(h=>h.toggleSelectedElement),s=p(h=>h.duplicateElements),l=p(h=>h.removeElements),n=p(h=>h.removeElement),u=x.useCallback((h,m)=>{m.ctrlKey||m.metaKey||m.shiftKey?i(h):r(h)},[r,i]);return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx(je,{children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Es,{className:"h-3 w-3"}),"Elements (",t.length,")"]})}),o.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>s(o),children:e.jsx(ie,{className:"h-3 w-3"})})}),e.jsxs(J,{side:"bottom",children:["Duplicate selected ",e.jsx("span",{className:"text-muted-foreground",children:"Ctrl+D"})]})]}),e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive",onClick:()=>{o.length>1?l(o):n(o[0])},children:e.jsx(ce,{className:"h-3 w-3"})})}),e.jsx(J,{side:"bottom",children:"Delete selected"})]})]})]}),t.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"No elements yet. Use tools above to add."}):e.jsx("div",{className:"space-y-0.5 max-h-48 overflow-y-auto",children:t.map(h=>{const m=o.includes(h.id);return e.jsxs("div",{className:ne("flex items-center gap-2 rounded-md px-2 py-1.5 text-xs cursor-pointer transition-colors",m?"bg-primary/10 text-primary ring-1 ring-primary/20":"hover:bg-muted/80 text-foreground"),onClick:c=>u(h.id,c),children:[$r[h.type],e.jsx("span",{className:"flex-1 truncate",children:Yr(h)}),h.type==="booth"&&h.isStartingPoint&&e.jsx($e,{className:"h-3 w-3 text-red-500 shrink-0"}),e.jsx(M,{variant:"ghost",size:"icon",className:"h-5 w-5 shrink-0 opacity-0 group-hover:opacity-100 hover:opacity-100",style:{opacity:m?.7:void 0},onClick:c=>{c.stopPropagation(),s([h.id])},children:e.jsx(ie,{className:"h-2.5 w-2.5"})})]},h.id)})}),o.length>1&&e.jsxs("p",{className:"mt-1.5 text-[10px] text-muted-foreground",children:[o.length," elements selected â€” Ctrl/Shift+click to multi-select"]})]})}function Or(){const t=p(r=>r.venue),o=p(r=>r.setVenue);return e.jsxs("div",{className:"space-y-3",children:[e.jsx(je,{children:"Canvas Settings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Width"}),e.jsx(v,{type:"number",value:t.width,onChange:r=>o({width:Number(r.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Height"}),e.jsx(v,{type:"number",value:t.height,onChange:r=>o({height:Number(r.target.value)}),className:"h-8 text-xs"})]})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Grid Size"}),e.jsx(v,{type:"number",value:t.gridSize,min:5,onChange:r=>o({gridSize:Number(r.target.value)}),className:"h-8 text-xs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-xs",children:"Show Grid"}),e.jsx(L,{checked:t.showGrid,onCheckedChange:r=>o({showGrid:r})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-xs",children:"Snap to Grid"}),e.jsx(L,{checked:t.snapToGrid,onCheckedChange:r=>o({snapToGrid:r})})]}),e.jsx(Ce,{label:"Background",children:e.jsx(v,{type:"color",value:t.backgroundColor,onChange:r=>o({backgroundColor:r.target.value}),className:"h-8 w-full cursor-pointer p-1"})}),e.jsxs("div",{children:[e.jsx(k,{className:"text-xs",children:"Background Image URL"}),e.jsx(v,{value:t.backgroundImage??"",onChange:r=>o({backgroundImage:r.target.value||void 0}),placeholder:"https://...",className:"h-8 text-xs"})]}),t.backgroundImage&&e.jsxs(e.Fragment,{children:[e.jsx(Ce,{label:"Background rotation (Â°)",children:e.jsx(v,{type:"number",value:t.backgroundRotation??0,onChange:r=>o({backgroundRotation:Number(r.target.value)}),className:"h-8 text-xs"})}),e.jsx(Ce,{label:"Background opacity",children:e.jsx(v,{type:"number",min:0,max:1,step:.1,value:t.backgroundOpacity??1,onChange:r=>o({backgroundOpacity:Number(r.target.value)}),className:"h-8 text-xs"})}),e.jsx(Ce,{label:"Background zoom",children:e.jsx(v,{type:"number",min:.1,max:3,step:.1,value:t.backgroundZoom??1,onChange:r=>o({backgroundZoom:Number(r.target.value)}),placeholder:"1 = 100%",className:"h-8 text-xs"})})]})]})}const Vr=["glow","scale","sparkle","shadow"],Fr=["glow","scale","sparkle","shadow"];function Ur({tierId:t,open:o,onOpenChange:r}){const i=p(c=>c.venue.tiers),s=p(c=>c.updateTier),l=t?i.find(c=>c.id===t)??null:null;if(!l)return null;const n=l.boothStyle??{},u=l.popupStyle??{},h=(c,a)=>s(l.id,{boothStyle:{...n,[c]:a}}),m=(c,a)=>s(l.id,{popupStyle:{...u,[c]:a}});return e.jsx(ls,{open:o,onOpenChange:r,children:e.jsxs(cs,{className:"sm:max-w-md",children:[e.jsxs(ds,{children:[e.jsxs(hs,{children:["Tier: ",l.name]}),e.jsx(xs,{children:"These styles apply to all booths with this tier. Booth appearance affects the map; popup appearance affects the detail card."})]}),e.jsxs("div",{className:"grid gap-6 py-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-sm font-medium",children:"Booth appearance (on map)"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Vr.map(c=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsxs("span",{className:"text-xs",children:[c==="glow"&&"Glowing effect",c==="scale"&&"Scaling effect",c==="sparkle"&&"Sparkling",c==="shadow"&&"Shadow effect"]}),e.jsx(L,{checked:!!n[c],onCheckedChange:a=>h(c,a)},`booth-switch-${c}`)]},`booth-${c}`))})]}),e.jsx(W,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-sm font-medium",children:"Popup details appearance"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Fr.map(c=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsxs("span",{className:"text-xs",children:[c==="glow"&&"Glowing effect",c==="scale"&&"Scaling effect",c==="sparkle"&&"Sparkling",c==="shadow"&&"Shadow effect"]}),e.jsx(L,{checked:!!u[c],onCheckedChange:a=>m(c,a)},`popup-switch-${c}`)]},`popup-${c}`))})]})]})]},t??"dialog")})}function Kr(){const t=p(n=>n.venue.tiers),o=p(n=>n.addTier),r=p(n=>n.updateTier),i=p(n=>n.removeTier),[s,l]=x.useState(null);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[e.jsx(je,{children:"Booth Tiers"}),e.jsxs(M,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs",onClick:o,children:[e.jsx(Ws,{className:"mr-1 h-3 w-3"}),"Add"]})]}),e.jsx("div",{className:"space-y-1.5",children:t.map((n,u)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(v,{value:n.name,onChange:h=>r(n.id,{name:h.target.value}),className:"h-8 flex-1 text-xs",placeholder:`Tier ${u+1}`}),e.jsx(M,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:()=>l(n),title:"Customize tier appearance",children:e.jsx(zs,{className:"h-3.5 w-3.5 text-muted-foreground"})}),e.jsx(M,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 text-destructive hover:text-destructive",disabled:t.length<=1,onClick:()=>i(n.id),title:t.length<=1?"Keep at least one tier":"Delete tier",children:e.jsx(ce,{className:"h-3.5 w-3.5"})})]},n.id))}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Tier is optional per booth. Use Customize (palette) for glow, scale, sparkle, shadow."}),e.jsx(Ur,{tierId:s?.id??null,open:!!s,onOpenChange:n=>!n&&l(null)})]})}function qr(){const{projectName:t=""}=es(),o=x.useRef(null),r=p(w=>w.getConfig),i=p(w=>w.loadConfig),s=p(w=>w.resetAll),l=p(w=>w.setPreviewMode),n=p(w=>w.setPreviewAsKiosk),u=p(w=>w.undo),h=p(w=>w.redo),m=p(w=>w.past.length>0),c=p(w=>w.future.length>0),a=x.useCallback(async()=>{const w=r(),B=t.trim().toLowerCase();if(!B){alert("Missing project name in route. Open via /admin/:projectName.");return}ts(B,w);try{await ss(B,w)}catch(H){console.error(H),alert("Failed to save manifest file.")}},[r,t]),b=x.useCallback(w=>{const B=w.target.files?.[0];if(!B)return;const H=new FileReader;H.onload=()=>{try{const I=JSON.parse(H.result);i(I)}catch{alert("Invalid JSON file")}},H.readAsText(B),w.target.value=""},[i]),R=x.useCallback(()=>{window.confirm("Reset all elements, paths, and settings? This cannot be undone.")&&s()},[s]);return e.jsx(He,{delayDuration:200,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:u,disabled:!m,"aria-label":"Undo",children:e.jsx(qs,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:"Undo"})]}),e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:h,disabled:!c,"aria-label":"Redo",children:e.jsx(Hs,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:"Redo"})]}),e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{n(!1),l(!0)},"aria-label":"Preview user mode",children:e.jsx(ws,{className:"h-3.5 w-3.5"})})}),e.jsxs(J,{children:["Preview (User) ",e.jsx("span",{className:"text-muted-foreground",children:"Alt+P"})]})]}),e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{n(!0),l(!0)},"aria-label":"Preview kiosk mode",children:e.jsx(Rs,{className:"h-3.5 w-3.5"})})}),e.jsxs(J,{children:["Preview (Kiosk) ",e.jsx("span",{className:"text-muted-foreground",children:"Alt+K"})]})]}),e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{a()},"aria-label":"Save venue",children:e.jsx(js,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:"Save Venue"})]}),e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>o.current?.click(),"aria-label":"Import manifest",children:e.jsx(Zs,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:"Import"})]}),e.jsxs(G,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(M,{variant:"destructive",size:"icon",className:"h-8 w-8 text-white",onClick:R,"aria-label":"Reset all",children:e.jsx(Ys,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:"Reset All"})]}),e.jsx("input",{ref:o,type:"file",accept:".json",className:"hidden",onChange:b})]})})}function Gr(){const t=p(r=>r.activityHistory),o=x.useMemo(()=>t.slice(0,10),[t]);return e.jsxs("div",{children:[e.jsx(je,{children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Ns,{className:"h-3 w-3"}),"Activity History"]})}),o.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"No activity yet."}):e.jsx("div",{className:"max-h-36 space-y-1 overflow-y-auto rounded-md border border-border/60 p-2",children:o.map(r=>e.jsxs("div",{className:"flex items-center justify-between gap-2 text-[11px]",children:[e.jsx("span",{className:"truncate text-foreground",children:r.label}),e.jsx("span",{className:"shrink-0 text-muted-foreground",children:new Date(r.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},r.id))})]})}function Zr(){return e.jsxs("aside",{className:"flex w-72 flex-col border-l border-border bg-background [&_button]:text-[12px] [&_h2]:text-[12px] [&_h3]:text-[12px] [&_input]:text-[12px] [&_label]:text-[12px] [&_p]:text-[12px] [&_span]:text-[12px]",children:[e.jsx("div",{className:"shrink-0 border-b border-border px-4 py-2",children:e.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:"Elements & Canvas"})}),e.jsx(Ue,{className:"flex-1",children:e.jsxs("div",{className:"space-y-5 p-4",children:[e.jsx(Hr,{}),e.jsx(W,{}),e.jsx(He,{delayDuration:200,children:e.jsx(Xr,{})}),e.jsx(W,{}),e.jsx(Or,{}),e.jsx(W,{}),e.jsx(Kr,{}),e.jsx(W,{}),e.jsx(Gr,{})]})})]})}function Jr(){const t=p(o=>o.venue);return e.jsxs("header",{className:"flex h-12 shrink-0 items-center justify-between gap-3 border-b border-border bg-background px-4 text-[12px]",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-[12px] font-semibold tracking-tight",children:"Venue Builder"}),e.jsxs("span",{className:"text-[12px] text-muted-foreground",children:[t.width," Ã— ",t.height]})]}),e.jsx("div",{className:"flex min-w-0 items-center justify-end overflow-x-auto",children:e.jsx(qr,{})})]})}function so(){const t=p(s=>s.isPreviewMode),o=p(s=>s.previewAsKiosk),r=p(s=>s.setPreviewMode),i=p(s=>s.getConfig);if(t){const s=i();return e.jsxs("div",{className:"relative h-screen w-screen",children:[e.jsx(us,{isKiosk:o,config:s}),e.jsxs(M,{variant:"destructive",size:"sm",className:"absolute right-4 top-4 z-50 shadow-lg",onClick:()=>r(!1),children:[e.jsx(ps,{className:"mr-1 h-4 w-4"})," Exit Preview"]})]})}return e.jsxs("div",{className:"flex h-screen flex-col overflow-hidden",children:[e.jsx(Jr,{}),e.jsx(Qr,{})]})}function Qr(){return fs(),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx(Wr,{}),e.jsx(ar,{}),e.jsx(Zr,{})]})}export{so as AdminApp};
